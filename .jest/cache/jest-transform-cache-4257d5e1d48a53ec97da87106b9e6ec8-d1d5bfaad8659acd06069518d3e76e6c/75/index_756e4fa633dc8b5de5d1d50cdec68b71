aaa0b6db482245d0c77244187f021037
'use strict';

exports.__esModule = true;
exports.default = void 0;
function ownKeys(object, enumerableOnly) {
  var keys = Object.keys(object);
  if (Object.getOwnPropertySymbols) {
    var symbols = Object.getOwnPropertySymbols(object);
    if (enumerableOnly) symbols = symbols.filter(function (sym) {
      return Object.getOwnPropertyDescriptor(object, sym).enumerable;
    });
    keys.push.apply(keys, symbols);
  }
  return keys;
}
function _objectSpread(target) {
  for (var i = 1; i < arguments.length; i++) {
    var source = arguments[i] != null ? arguments[i] : {};
    if (i % 2) {
      ownKeys(Object(source), true).forEach(function (key) {
        _defineProperty(target, key, source[key]);
      });
    } else if (Object.getOwnPropertyDescriptors) {
      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));
    } else {
      ownKeys(Object(source)).forEach(function (key) {
        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));
      });
    }
  }
  return target;
}
function _defineProperty(obj, key, value) {
  if (key in obj) {
    Object.defineProperty(obj, key, {
      value: value,
      enumerable: true,
      configurable: true,
      writable: true
    });
  } else {
    obj[key] = value;
  }
  return obj;
}
var Info = function Info() {
  this.any_blank_count = 0;
  this.any_blank_ms = 0;
  this.any_blank_speed_sum = 0;
  this.mostly_blank_count = 0;
  this.mostly_blank_ms = 0;
  this.pixels_blank = 0;
  this.pixels_sampled = 0;
  this.pixels_scrolled = 0;
  this.total_time_spent = 0;
  this.sample_count = 0;
};
var DEBUG = false;
var _listeners = [];
var _minSampleCount = 10;
var _sampleRate = DEBUG ? 1 : null;
var FillRateHelper = function () {
  FillRateHelper.addListener = function addListener(callback) {
    if (_sampleRate === null) {
      console.warn('Call `FillRateHelper.setSampleRate` before `addListener`.');
    }
    _listeners.push(callback);
    return {
      remove: function remove() {
        _listeners = _listeners.filter(function (listener) {
          return callback !== listener;
        });
      }
    };
  };
  FillRateHelper.setSampleRate = function setSampleRate(sampleRate) {
    _sampleRate = sampleRate;
  };
  FillRateHelper.setMinSampleCount = function setMinSampleCount(minSampleCount) {
    _minSampleCount = minSampleCount;
  };
  function FillRateHelper(getFrameMetrics) {
    this._anyBlankStartTime = null;
    this._enabled = false;
    this._info = new Info();
    this._mostlyBlankStartTime = null;
    this._samplesStartTime = null;
    this._getFrameMetrics = getFrameMetrics;
    this._enabled = (_sampleRate || 0) > Math.random();
    this._resetData();
  }
  var _proto = FillRateHelper.prototype;
  _proto.activate = function activate() {
    if (this._enabled && this._samplesStartTime == null) {
      DEBUG && console.debug('FillRateHelper: activate');
      this._samplesStartTime = global.performance.now();
    }
  };
  _proto.deactivateAndFlush = function deactivateAndFlush() {
    if (!this._enabled) {
      return;
    }
    var start = this._samplesStartTime;
    if (start == null) {
      DEBUG && console.debug('FillRateHelper: bail on deactivate with no start time');
      return;
    }
    if (this._info.sample_count < _minSampleCount) {
      this._resetData();
      return;
    }
    var total_time_spent = global.performance.now() - start;
    var info = _objectSpread(_objectSpread({}, this._info), {}, {
      total_time_spent: total_time_spent
    });
    if (DEBUG) {
      var derived = {
        avg_blankness: this._info.pixels_blank / this._info.pixels_sampled,
        avg_speed: this._info.pixels_scrolled / (total_time_spent / 1000),
        avg_speed_when_any_blank: this._info.any_blank_speed_sum / this._info.any_blank_count,
        any_blank_per_min: this._info.any_blank_count / (total_time_spent / 1000 / 60),
        any_blank_time_frac: this._info.any_blank_ms / total_time_spent,
        mostly_blank_per_min: this._info.mostly_blank_count / (total_time_spent / 1000 / 60),
        mostly_blank_time_frac: this._info.mostly_blank_ms / total_time_spent
      };
      for (var key in derived) {
        derived[key] = Math.round(1000 * derived[key]) / 1000;
      }
      console.debug('FillRateHelper deactivateAndFlush: ', {
        derived: derived,
        info: info
      });
    }
    _listeners.forEach(function (listener) {
      return listener(info);
    });
    this._resetData();
  };
  _proto.computeBlankness = function computeBlankness(props, state, scrollMetrics) {
    if (!this._enabled || props.getItemCount(props.data) === 0 || this._samplesStartTime == null) {
      return 0;
    }
    var dOffset = scrollMetrics.dOffset,
      offset = scrollMetrics.offset,
      velocity = scrollMetrics.velocity,
      visibleLength = scrollMetrics.visibleLength;
    this._info.sample_count++;
    this._info.pixels_sampled += Math.round(visibleLength);
    this._info.pixels_scrolled += Math.round(Math.abs(dOffset));
    var scrollSpeed = Math.round(Math.abs(velocity) * 1000);
    var now = global.performance.now();
    if (this._anyBlankStartTime != null) {
      this._info.any_blank_ms += now - this._anyBlankStartTime;
    }
    this._anyBlankStartTime = null;
    if (this._mostlyBlankStartTime != null) {
      this._info.mostly_blank_ms += now - this._mostlyBlankStartTime;
    }
    this._mostlyBlankStartTime = null;
    var blankTop = 0;
    var first = state.first;
    var firstFrame = this._getFrameMetrics(first);
    while (first <= state.last && (!firstFrame || !firstFrame.inLayout)) {
      firstFrame = this._getFrameMetrics(first);
      first++;
    }
    if (firstFrame && first > 0) {
      blankTop = Math.min(visibleLength, Math.max(0, firstFrame.offset - offset));
    }
    var blankBottom = 0;
    var last = state.last;
    var lastFrame = this._getFrameMetrics(last);
    while (last >= state.first && (!lastFrame || !lastFrame.inLayout)) {
      lastFrame = this._getFrameMetrics(last);
      last--;
    }
    if (lastFrame && last < props.getItemCount(props.data) - 1) {
      var bottomEdge = lastFrame.offset + lastFrame.length;
      blankBottom = Math.min(visibleLength, Math.max(0, offset + visibleLength - bottomEdge));
    }
    var pixels_blank = Math.round(blankTop + blankBottom);
    var blankness = pixels_blank / visibleLength;
    if (blankness > 0) {
      this._anyBlankStartTime = now;
      this._info.any_blank_speed_sum += scrollSpeed;
      this._info.any_blank_count++;
      this._info.pixels_blank += pixels_blank;
      if (blankness > 0.5) {
        this._mostlyBlankStartTime = now;
        this._info.mostly_blank_count++;
      }
    } else if (scrollSpeed < 0.01 || Math.abs(dOffset) < 1) {
      this.deactivateAndFlush();
    }
    return blankness;
  };
  _proto.enabled = function enabled() {
    return this._enabled;
  };
  _proto._resetData = function _resetData() {
    this._anyBlankStartTime = null;
    this._info = new Info();
    this._mostlyBlankStartTime = null;
    this._samplesStartTime = null;
  };
  return FillRateHelper;
}();
var _default = FillRateHelper;
exports.default = _default;
module.exports = exports.default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHBvcnRzIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJvd25LZXlzIiwib2JqZWN0IiwiZW51bWVyYWJsZU9ubHkiLCJrZXlzIiwiT2JqZWN0IiwiZ2V0T3duUHJvcGVydHlTeW1ib2xzIiwic3ltYm9scyIsImZpbHRlciIsInN5bSIsImdldE93blByb3BlcnR5RGVzY3JpcHRvciIsImVudW1lcmFibGUiLCJwdXNoIiwiYXBwbHkiLCJfb2JqZWN0U3ByZWFkIiwidGFyZ2V0IiwiaSIsImFyZ3VtZW50cyIsImxlbmd0aCIsInNvdXJjZSIsImZvckVhY2giLCJrZXkiLCJfZGVmaW5lUHJvcGVydHkiLCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzIiwiZGVmaW5lUHJvcGVydGllcyIsImRlZmluZVByb3BlcnR5Iiwib2JqIiwidmFsdWUiLCJjb25maWd1cmFibGUiLCJ3cml0YWJsZSIsIkluZm8iLCJhbnlfYmxhbmtfY291bnQiLCJhbnlfYmxhbmtfbXMiLCJhbnlfYmxhbmtfc3BlZWRfc3VtIiwibW9zdGx5X2JsYW5rX2NvdW50IiwibW9zdGx5X2JsYW5rX21zIiwicGl4ZWxzX2JsYW5rIiwicGl4ZWxzX3NhbXBsZWQiLCJwaXhlbHNfc2Nyb2xsZWQiLCJ0b3RhbF90aW1lX3NwZW50Iiwic2FtcGxlX2NvdW50IiwiREVCVUciLCJfbGlzdGVuZXJzIiwiX21pblNhbXBsZUNvdW50IiwiX3NhbXBsZVJhdGUiLCJGaWxsUmF0ZUhlbHBlciIsImFkZExpc3RlbmVyIiwiY2FsbGJhY2siLCJjb25zb2xlIiwid2FybiIsInJlbW92ZSIsImxpc3RlbmVyIiwic2V0U2FtcGxlUmF0ZSIsInNhbXBsZVJhdGUiLCJzZXRNaW5TYW1wbGVDb3VudCIsIm1pblNhbXBsZUNvdW50IiwiZ2V0RnJhbWVNZXRyaWNzIiwiX2FueUJsYW5rU3RhcnRUaW1lIiwiX2VuYWJsZWQiLCJfaW5mbyIsIl9tb3N0bHlCbGFua1N0YXJ0VGltZSIsIl9zYW1wbGVzU3RhcnRUaW1lIiwiX2dldEZyYW1lTWV0cmljcyIsIk1hdGgiLCJyYW5kb20iLCJfcmVzZXREYXRhIiwiX3Byb3RvIiwicHJvdG90eXBlIiwiYWN0aXZhdGUiLCJkZWJ1ZyIsImdsb2JhbCIsInBlcmZvcm1hbmNlIiwibm93IiwiZGVhY3RpdmF0ZUFuZEZsdXNoIiwic3RhcnQiLCJpbmZvIiwiZGVyaXZlZCIsImF2Z19ibGFua25lc3MiLCJhdmdfc3BlZWQiLCJhdmdfc3BlZWRfd2hlbl9hbnlfYmxhbmsiLCJhbnlfYmxhbmtfcGVyX21pbiIsImFueV9ibGFua190aW1lX2ZyYWMiLCJtb3N0bHlfYmxhbmtfcGVyX21pbiIsIm1vc3RseV9ibGFua190aW1lX2ZyYWMiLCJyb3VuZCIsImNvbXB1dGVCbGFua25lc3MiLCJwcm9wcyIsInN0YXRlIiwic2Nyb2xsTWV0cmljcyIsImdldEl0ZW1Db3VudCIsImRhdGEiLCJkT2Zmc2V0Iiwib2Zmc2V0IiwidmVsb2NpdHkiLCJ2aXNpYmxlTGVuZ3RoIiwiYWJzIiwic2Nyb2xsU3BlZWQiLCJibGFua1RvcCIsImZpcnN0IiwiZmlyc3RGcmFtZSIsImxhc3QiLCJpbkxheW91dCIsIm1pbiIsIm1heCIsImJsYW5rQm90dG9tIiwibGFzdEZyYW1lIiwiYm90dG9tRWRnZSIsImJsYW5rbmVzcyIsImVuYWJsZWQiLCJfZGVmYXVsdCIsIm1vZHVsZSJdLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQ29weXJpZ2h0IChjKSBGYWNlYm9vaywgSW5jLiBhbmQgaXRzIGFmZmlsaWF0ZXMuXG4gKlxuICogVGhpcyBzb3VyY2UgY29kZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UgZm91bmQgaW4gdGhlXG4gKiBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoaXMgc291cmNlIHRyZWUuXG4gKlxuICogXG4gKiBAZm9ybWF0XG4gKi9cbid1c2Ugc3RyaWN0JztcblxuZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcbmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDtcblxuZnVuY3Rpb24gb3duS2V5cyhvYmplY3QsIGVudW1lcmFibGVPbmx5KSB7IHZhciBrZXlzID0gT2JqZWN0LmtleXMob2JqZWN0KTsgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHsgdmFyIHN5bWJvbHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKG9iamVjdCk7IGlmIChlbnVtZXJhYmxlT25seSkgc3ltYm9scyA9IHN5bWJvbHMuZmlsdGVyKGZ1bmN0aW9uIChzeW0pIHsgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBzeW0pLmVudW1lcmFibGU7IH0pOyBrZXlzLnB1c2guYXBwbHkoa2V5cywgc3ltYm9scyk7IH0gcmV0dXJuIGtleXM7IH1cblxuZnVuY3Rpb24gX29iamVjdFNwcmVhZCh0YXJnZXQpIHsgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXSAhPSBudWxsID8gYXJndW1lbnRzW2ldIDoge307IGlmIChpICUgMikgeyBvd25LZXlzKE9iamVjdChzb3VyY2UpLCB0cnVlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsgX2RlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBzb3VyY2Vba2V5XSk7IH0pOyB9IGVsc2UgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMoc291cmNlKSk7IH0gZWxzZSB7IG93bktleXMoT2JqZWN0KHNvdXJjZSkpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc291cmNlLCBrZXkpKTsgfSk7IH0gfSByZXR1cm4gdGFyZ2V0OyB9XG5cbmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsgaWYgKGtleSBpbiBvYmopIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7IHZhbHVlOiB2YWx1ZSwgZW51bWVyYWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlLCB3cml0YWJsZTogdHJ1ZSB9KTsgfSBlbHNlIHsgb2JqW2tleV0gPSB2YWx1ZTsgfSByZXR1cm4gb2JqOyB9XG5cbnZhciBJbmZvID0gZnVuY3Rpb24gSW5mbygpIHtcbiAgdGhpcy5hbnlfYmxhbmtfY291bnQgPSAwO1xuICB0aGlzLmFueV9ibGFua19tcyA9IDA7XG4gIHRoaXMuYW55X2JsYW5rX3NwZWVkX3N1bSA9IDA7XG4gIHRoaXMubW9zdGx5X2JsYW5rX2NvdW50ID0gMDtcbiAgdGhpcy5tb3N0bHlfYmxhbmtfbXMgPSAwO1xuICB0aGlzLnBpeGVsc19ibGFuayA9IDA7XG4gIHRoaXMucGl4ZWxzX3NhbXBsZWQgPSAwO1xuICB0aGlzLnBpeGVsc19zY3JvbGxlZCA9IDA7XG4gIHRoaXMudG90YWxfdGltZV9zcGVudCA9IDA7XG4gIHRoaXMuc2FtcGxlX2NvdW50ID0gMDtcbn07XG5cbnZhciBERUJVRyA9IGZhbHNlO1xudmFyIF9saXN0ZW5lcnMgPSBbXTtcbnZhciBfbWluU2FtcGxlQ291bnQgPSAxMDtcblxudmFyIF9zYW1wbGVSYXRlID0gREVCVUcgPyAxIDogbnVsbDtcbi8qKlxuICogQSBoZWxwZXIgY2xhc3MgZm9yIGRldGVjdGluZyB3aGVuIHRoZSBtYXhpbWVtIGZpbGwgcmF0ZSBvZiBgVmlydHVhbGl6ZWRMaXN0YCBpcyBleGNlZWRlZC5cbiAqIEJ5IGRlZmF1bHQgdGhlIHNhbXBsaW5nIHJhdGUgaXMgc2V0IHRvIHplcm8gYW5kIHRoaXMgd2lsbCBkbyBub3RoaW5nLiBJZiB5b3Ugd2FudCB0byBjb2xsZWN0XG4gKiBzYW1wbGVzIChlLmcuIHRvIGxvZyB0aGVtKSwgbWFrZSBzdXJlIHRvIGNhbGwgYEZpbGxSYXRlSGVscGVyLnNldFNhbXBsZVJhdGUoMC4wLTEuMClgLlxuICpcbiAqIExpc3RlbmVycyBhbmQgc2FtcGxlIHJhdGUgYXJlIGdsb2JhbCBmb3IgYWxsIGBWaXJ0dWFsaXplZExpc3RgcyAtIHR5cGljYWwgdXNhZ2Ugd2lsbCBjb21iaW5lIHdpdGhcbiAqIGBTY2VuZVRyYWNrZXIuZ2V0QWN0aXZlU2NlbmVgIHRvIGRldGVybWluZSB0aGUgY29udGV4dCBvZiB0aGUgZXZlbnRzLlxuICovXG5cblxudmFyIEZpbGxSYXRlSGVscGVyID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcbiAgRmlsbFJhdGVIZWxwZXIuYWRkTGlzdGVuZXIgPSBmdW5jdGlvbiBhZGRMaXN0ZW5lcihjYWxsYmFjaykge1xuICAgIGlmIChfc2FtcGxlUmF0ZSA9PT0gbnVsbCkge1xuICAgICAgY29uc29sZS53YXJuKCdDYWxsIGBGaWxsUmF0ZUhlbHBlci5zZXRTYW1wbGVSYXRlYCBiZWZvcmUgYGFkZExpc3RlbmVyYC4nKTtcbiAgICB9XG5cbiAgICBfbGlzdGVuZXJzLnB1c2goY2FsbGJhY2spO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIHJlbW92ZTogZnVuY3Rpb24gcmVtb3ZlKCkge1xuICAgICAgICBfbGlzdGVuZXJzID0gX2xpc3RlbmVycy5maWx0ZXIoZnVuY3Rpb24gKGxpc3RlbmVyKSB7XG4gICAgICAgICAgcmV0dXJuIGNhbGxiYWNrICE9PSBsaXN0ZW5lcjtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfTtcbiAgfTtcblxuICBGaWxsUmF0ZUhlbHBlci5zZXRTYW1wbGVSYXRlID0gZnVuY3Rpb24gc2V0U2FtcGxlUmF0ZShzYW1wbGVSYXRlKSB7XG4gICAgX3NhbXBsZVJhdGUgPSBzYW1wbGVSYXRlO1xuICB9O1xuXG4gIEZpbGxSYXRlSGVscGVyLnNldE1pblNhbXBsZUNvdW50ID0gZnVuY3Rpb24gc2V0TWluU2FtcGxlQ291bnQobWluU2FtcGxlQ291bnQpIHtcbiAgICBfbWluU2FtcGxlQ291bnQgPSBtaW5TYW1wbGVDb3VudDtcbiAgfTtcblxuICBmdW5jdGlvbiBGaWxsUmF0ZUhlbHBlcihnZXRGcmFtZU1ldHJpY3MpIHtcbiAgICB0aGlzLl9hbnlCbGFua1N0YXJ0VGltZSA9IG51bGw7XG4gICAgdGhpcy5fZW5hYmxlZCA9IGZhbHNlO1xuICAgIHRoaXMuX2luZm8gPSBuZXcgSW5mbygpO1xuICAgIHRoaXMuX21vc3RseUJsYW5rU3RhcnRUaW1lID0gbnVsbDtcbiAgICB0aGlzLl9zYW1wbGVzU3RhcnRUaW1lID0gbnVsbDtcbiAgICB0aGlzLl9nZXRGcmFtZU1ldHJpY3MgPSBnZXRGcmFtZU1ldHJpY3M7XG4gICAgdGhpcy5fZW5hYmxlZCA9IChfc2FtcGxlUmF0ZSB8fCAwKSA+IE1hdGgucmFuZG9tKCk7XG5cbiAgICB0aGlzLl9yZXNldERhdGEoKTtcbiAgfVxuXG4gIHZhciBfcHJvdG8gPSBGaWxsUmF0ZUhlbHBlci5wcm90b3R5cGU7XG5cbiAgX3Byb3RvLmFjdGl2YXRlID0gZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgaWYgKHRoaXMuX2VuYWJsZWQgJiYgdGhpcy5fc2FtcGxlc1N0YXJ0VGltZSA9PSBudWxsKSB7XG4gICAgICBERUJVRyAmJiBjb25zb2xlLmRlYnVnKCdGaWxsUmF0ZUhlbHBlcjogYWN0aXZhdGUnKTtcbiAgICAgIHRoaXMuX3NhbXBsZXNTdGFydFRpbWUgPSBnbG9iYWwucGVyZm9ybWFuY2Uubm93KCk7XG4gICAgfVxuICB9O1xuXG4gIF9wcm90by5kZWFjdGl2YXRlQW5kRmx1c2ggPSBmdW5jdGlvbiBkZWFjdGl2YXRlQW5kRmx1c2goKSB7XG4gICAgaWYgKCF0aGlzLl9lbmFibGVkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdmFyIHN0YXJ0ID0gdGhpcy5fc2FtcGxlc1N0YXJ0VGltZTsgLy8gY29uc3QgZm9yIGZsb3dcblxuICAgIGlmIChzdGFydCA9PSBudWxsKSB7XG4gICAgICBERUJVRyAmJiBjb25zb2xlLmRlYnVnKCdGaWxsUmF0ZUhlbHBlcjogYmFpbCBvbiBkZWFjdGl2YXRlIHdpdGggbm8gc3RhcnQgdGltZScpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmICh0aGlzLl9pbmZvLnNhbXBsZV9jb3VudCA8IF9taW5TYW1wbGVDb3VudCkge1xuICAgICAgLy8gRG9uJ3QgYm90aGVyIHdpdGggdW5kZXItc2FtcGxlZCBldmVudHMuXG4gICAgICB0aGlzLl9yZXNldERhdGEoKTtcblxuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHZhciB0b3RhbF90aW1lX3NwZW50ID0gZ2xvYmFsLnBlcmZvcm1hbmNlLm5vdygpIC0gc3RhcnQ7XG5cbiAgICB2YXIgaW5mbyA9IF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgdGhpcy5faW5mbyksIHt9LCB7XG4gICAgICB0b3RhbF90aW1lX3NwZW50OiB0b3RhbF90aW1lX3NwZW50XG4gICAgfSk7XG5cbiAgICBpZiAoREVCVUcpIHtcbiAgICAgIHZhciBkZXJpdmVkID0ge1xuICAgICAgICBhdmdfYmxhbmtuZXNzOiB0aGlzLl9pbmZvLnBpeGVsc19ibGFuayAvIHRoaXMuX2luZm8ucGl4ZWxzX3NhbXBsZWQsXG4gICAgICAgIGF2Z19zcGVlZDogdGhpcy5faW5mby5waXhlbHNfc2Nyb2xsZWQgLyAodG90YWxfdGltZV9zcGVudCAvIDEwMDApLFxuICAgICAgICBhdmdfc3BlZWRfd2hlbl9hbnlfYmxhbms6IHRoaXMuX2luZm8uYW55X2JsYW5rX3NwZWVkX3N1bSAvIHRoaXMuX2luZm8uYW55X2JsYW5rX2NvdW50LFxuICAgICAgICBhbnlfYmxhbmtfcGVyX21pbjogdGhpcy5faW5mby5hbnlfYmxhbmtfY291bnQgLyAodG90YWxfdGltZV9zcGVudCAvIDEwMDAgLyA2MCksXG4gICAgICAgIGFueV9ibGFua190aW1lX2ZyYWM6IHRoaXMuX2luZm8uYW55X2JsYW5rX21zIC8gdG90YWxfdGltZV9zcGVudCxcbiAgICAgICAgbW9zdGx5X2JsYW5rX3Blcl9taW46IHRoaXMuX2luZm8ubW9zdGx5X2JsYW5rX2NvdW50IC8gKHRvdGFsX3RpbWVfc3BlbnQgLyAxMDAwIC8gNjApLFxuICAgICAgICBtb3N0bHlfYmxhbmtfdGltZV9mcmFjOiB0aGlzLl9pbmZvLm1vc3RseV9ibGFua19tcyAvIHRvdGFsX3RpbWVfc3BlbnRcbiAgICAgIH07XG5cbiAgICAgIGZvciAodmFyIGtleSBpbiBkZXJpdmVkKSB7XG4gICAgICAgIGRlcml2ZWRba2V5XSA9IE1hdGgucm91bmQoMTAwMCAqIGRlcml2ZWRba2V5XSkgLyAxMDAwO1xuICAgICAgfVxuXG4gICAgICBjb25zb2xlLmRlYnVnKCdGaWxsUmF0ZUhlbHBlciBkZWFjdGl2YXRlQW5kRmx1c2g6ICcsIHtcbiAgICAgICAgZGVyaXZlZDogZGVyaXZlZCxcbiAgICAgICAgaW5mbzogaW5mb1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgX2xpc3RlbmVycy5mb3JFYWNoKGZ1bmN0aW9uIChsaXN0ZW5lcikge1xuICAgICAgcmV0dXJuIGxpc3RlbmVyKGluZm8pO1xuICAgIH0pO1xuXG4gICAgdGhpcy5fcmVzZXREYXRhKCk7XG4gIH07XG5cbiAgX3Byb3RvLmNvbXB1dGVCbGFua25lc3MgPSBmdW5jdGlvbiBjb21wdXRlQmxhbmtuZXNzKHByb3BzLCBzdGF0ZSwgc2Nyb2xsTWV0cmljcykge1xuICAgIGlmICghdGhpcy5fZW5hYmxlZCB8fCBwcm9wcy5nZXRJdGVtQ291bnQocHJvcHMuZGF0YSkgPT09IDAgfHwgdGhpcy5fc2FtcGxlc1N0YXJ0VGltZSA9PSBudWxsKSB7XG4gICAgICByZXR1cm4gMDtcbiAgICB9XG5cbiAgICB2YXIgZE9mZnNldCA9IHNjcm9sbE1ldHJpY3MuZE9mZnNldCxcbiAgICAgICAgb2Zmc2V0ID0gc2Nyb2xsTWV0cmljcy5vZmZzZXQsXG4gICAgICAgIHZlbG9jaXR5ID0gc2Nyb2xsTWV0cmljcy52ZWxvY2l0eSxcbiAgICAgICAgdmlzaWJsZUxlbmd0aCA9IHNjcm9sbE1ldHJpY3MudmlzaWJsZUxlbmd0aDsgLy8gRGVub21pbmF0b3IgbWV0cmljcyB0aGF0IHdlIHRyYWNrIGZvciBhbGwgZXZlbnRzIC0gbW9zdCBvZiB0aGUgdGltZSB0aGVyZSBpcyBubyBibGFua25lc3MgYW5kXG4gICAgLy8gd2Ugd2FudCB0byBjYXB0dXJlIHRoYXQuXG5cbiAgICB0aGlzLl9pbmZvLnNhbXBsZV9jb3VudCsrO1xuICAgIHRoaXMuX2luZm8ucGl4ZWxzX3NhbXBsZWQgKz0gTWF0aC5yb3VuZCh2aXNpYmxlTGVuZ3RoKTtcbiAgICB0aGlzLl9pbmZvLnBpeGVsc19zY3JvbGxlZCArPSBNYXRoLnJvdW5kKE1hdGguYWJzKGRPZmZzZXQpKTtcbiAgICB2YXIgc2Nyb2xsU3BlZWQgPSBNYXRoLnJvdW5kKE1hdGguYWJzKHZlbG9jaXR5KSAqIDEwMDApOyAvLyBweCAvIHNlY1xuICAgIC8vIFdoZXRoZXIgYmxhbmsgbm93IG9yIG5vdCwgcmVjb3JkIHRoZSBlbGFwc2VkIHRpbWUgYmxhbmsgaWYgd2Ugd2VyZSBibGFuayBsYXN0IHRpbWUuXG5cbiAgICB2YXIgbm93ID0gZ2xvYmFsLnBlcmZvcm1hbmNlLm5vdygpO1xuXG4gICAgaWYgKHRoaXMuX2FueUJsYW5rU3RhcnRUaW1lICE9IG51bGwpIHtcbiAgICAgIHRoaXMuX2luZm8uYW55X2JsYW5rX21zICs9IG5vdyAtIHRoaXMuX2FueUJsYW5rU3RhcnRUaW1lO1xuICAgIH1cblxuICAgIHRoaXMuX2FueUJsYW5rU3RhcnRUaW1lID0gbnVsbDtcblxuICAgIGlmICh0aGlzLl9tb3N0bHlCbGFua1N0YXJ0VGltZSAhPSBudWxsKSB7XG4gICAgICB0aGlzLl9pbmZvLm1vc3RseV9ibGFua19tcyArPSBub3cgLSB0aGlzLl9tb3N0bHlCbGFua1N0YXJ0VGltZTtcbiAgICB9XG5cbiAgICB0aGlzLl9tb3N0bHlCbGFua1N0YXJ0VGltZSA9IG51bGw7XG4gICAgdmFyIGJsYW5rVG9wID0gMDtcbiAgICB2YXIgZmlyc3QgPSBzdGF0ZS5maXJzdDtcblxuICAgIHZhciBmaXJzdEZyYW1lID0gdGhpcy5fZ2V0RnJhbWVNZXRyaWNzKGZpcnN0KTtcblxuICAgIHdoaWxlIChmaXJzdCA8PSBzdGF0ZS5sYXN0ICYmICghZmlyc3RGcmFtZSB8fCAhZmlyc3RGcmFtZS5pbkxheW91dCkpIHtcbiAgICAgIGZpcnN0RnJhbWUgPSB0aGlzLl9nZXRGcmFtZU1ldHJpY3MoZmlyc3QpO1xuICAgICAgZmlyc3QrKztcbiAgICB9IC8vIE9ubHkgY291bnQgYmxhbmtUb3AgaWYgd2UgYXJlbid0IHJlbmRlcmluZyB0aGUgZmlyc3QgaXRlbSwgb3RoZXJ3aXNlIHdlIHdpbGwgY291bnQgdGhlIGhlYWRlclxuICAgIC8vIGFzIGJsYW5rLlxuXG5cbiAgICBpZiAoZmlyc3RGcmFtZSAmJiBmaXJzdCA+IDApIHtcbiAgICAgIGJsYW5rVG9wID0gTWF0aC5taW4odmlzaWJsZUxlbmd0aCwgTWF0aC5tYXgoMCwgZmlyc3RGcmFtZS5vZmZzZXQgLSBvZmZzZXQpKTtcbiAgICB9XG5cbiAgICB2YXIgYmxhbmtCb3R0b20gPSAwO1xuICAgIHZhciBsYXN0ID0gc3RhdGUubGFzdDtcblxuICAgIHZhciBsYXN0RnJhbWUgPSB0aGlzLl9nZXRGcmFtZU1ldHJpY3MobGFzdCk7XG5cbiAgICB3aGlsZSAobGFzdCA+PSBzdGF0ZS5maXJzdCAmJiAoIWxhc3RGcmFtZSB8fCAhbGFzdEZyYW1lLmluTGF5b3V0KSkge1xuICAgICAgbGFzdEZyYW1lID0gdGhpcy5fZ2V0RnJhbWVNZXRyaWNzKGxhc3QpO1xuICAgICAgbGFzdC0tO1xuICAgIH0gLy8gT25seSBjb3VudCBibGFua0JvdHRvbSBpZiB3ZSBhcmVuJ3QgcmVuZGVyaW5nIHRoZSBsYXN0IGl0ZW0sIG90aGVyd2lzZSB3ZSB3aWxsIGNvdW50IHRoZVxuICAgIC8vIGZvb3RlciBhcyBibGFuay5cblxuXG4gICAgaWYgKGxhc3RGcmFtZSAmJiBsYXN0IDwgcHJvcHMuZ2V0SXRlbUNvdW50KHByb3BzLmRhdGEpIC0gMSkge1xuICAgICAgdmFyIGJvdHRvbUVkZ2UgPSBsYXN0RnJhbWUub2Zmc2V0ICsgbGFzdEZyYW1lLmxlbmd0aDtcbiAgICAgIGJsYW5rQm90dG9tID0gTWF0aC5taW4odmlzaWJsZUxlbmd0aCwgTWF0aC5tYXgoMCwgb2Zmc2V0ICsgdmlzaWJsZUxlbmd0aCAtIGJvdHRvbUVkZ2UpKTtcbiAgICB9XG5cbiAgICB2YXIgcGl4ZWxzX2JsYW5rID0gTWF0aC5yb3VuZChibGFua1RvcCArIGJsYW5rQm90dG9tKTtcbiAgICB2YXIgYmxhbmtuZXNzID0gcGl4ZWxzX2JsYW5rIC8gdmlzaWJsZUxlbmd0aDtcblxuICAgIGlmIChibGFua25lc3MgPiAwKSB7XG4gICAgICB0aGlzLl9hbnlCbGFua1N0YXJ0VGltZSA9IG5vdztcbiAgICAgIHRoaXMuX2luZm8uYW55X2JsYW5rX3NwZWVkX3N1bSArPSBzY3JvbGxTcGVlZDtcbiAgICAgIHRoaXMuX2luZm8uYW55X2JsYW5rX2NvdW50Kys7XG4gICAgICB0aGlzLl9pbmZvLnBpeGVsc19ibGFuayArPSBwaXhlbHNfYmxhbms7XG5cbiAgICAgIGlmIChibGFua25lc3MgPiAwLjUpIHtcbiAgICAgICAgdGhpcy5fbW9zdGx5QmxhbmtTdGFydFRpbWUgPSBub3c7XG4gICAgICAgIHRoaXMuX2luZm8ubW9zdGx5X2JsYW5rX2NvdW50Kys7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChzY3JvbGxTcGVlZCA8IDAuMDEgfHwgTWF0aC5hYnMoZE9mZnNldCkgPCAxKSB7XG4gICAgICB0aGlzLmRlYWN0aXZhdGVBbmRGbHVzaCgpO1xuICAgIH1cblxuICAgIHJldHVybiBibGFua25lc3M7XG4gIH07XG5cbiAgX3Byb3RvLmVuYWJsZWQgPSBmdW5jdGlvbiBlbmFibGVkKCkge1xuICAgIHJldHVybiB0aGlzLl9lbmFibGVkO1xuICB9O1xuXG4gIF9wcm90by5fcmVzZXREYXRhID0gZnVuY3Rpb24gX3Jlc2V0RGF0YSgpIHtcbiAgICB0aGlzLl9hbnlCbGFua1N0YXJ0VGltZSA9IG51bGw7XG4gICAgdGhpcy5faW5mbyA9IG5ldyBJbmZvKCk7XG4gICAgdGhpcy5fbW9zdGx5QmxhbmtTdGFydFRpbWUgPSBudWxsO1xuICAgIHRoaXMuX3NhbXBsZXNTdGFydFRpbWUgPSBudWxsO1xuICB9O1xuXG4gIHJldHVybiBGaWxsUmF0ZUhlbHBlcjtcbn0oKTtcblxudmFyIF9kZWZhdWx0ID0gRmlsbFJhdGVIZWxwZXI7XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbm1vZHVsZS5leHBvcnRzID0gZXhwb3J0cy5kZWZhdWx0OyJdLCJtYXBwaW5ncyI6IkFBU0EsWUFBWTs7QUFFWkEsT0FBTyxDQUFDQyxVQUFVLEdBQUcsSUFBSTtBQUN6QkQsT0FBTyxDQUFDRSxPQUFPLEdBQUcsS0FBSyxDQUFDO0FBRXhCLFNBQVNDLE9BQU9BLENBQUNDLE1BQU0sRUFBRUMsY0FBYyxFQUFFO0VBQUUsSUFBSUMsSUFBSSxHQUFHQyxNQUFNLENBQUNELElBQUksQ0FBQ0YsTUFBTSxDQUFDO0VBQUUsSUFBSUcsTUFBTSxDQUFDQyxxQkFBcUIsRUFBRTtJQUFFLElBQUlDLE9BQU8sR0FBR0YsTUFBTSxDQUFDQyxxQkFBcUIsQ0FBQ0osTUFBTSxDQUFDO0lBQUUsSUFBSUMsY0FBYyxFQUFFSSxPQUFPLEdBQUdBLE9BQU8sQ0FBQ0MsTUFBTSxDQUFDLFVBQVVDLEdBQUcsRUFBRTtNQUFFLE9BQU9KLE1BQU0sQ0FBQ0ssd0JBQXdCLENBQUNSLE1BQU0sRUFBRU8sR0FBRyxDQUFDLENBQUNFLFVBQVU7SUFBRSxDQUFDLENBQUM7SUFBRVAsSUFBSSxDQUFDUSxJQUFJLENBQUNDLEtBQUssQ0FBQ1QsSUFBSSxFQUFFRyxPQUFPLENBQUM7RUFBRTtFQUFFLE9BQU9ILElBQUk7QUFBRTtBQUVwVixTQUFTVSxhQUFhQSxDQUFDQyxNQUFNLEVBQUU7RUFBRSxLQUFLLElBQUlDLENBQUMsR0FBRyxDQUFDLEVBQUVBLENBQUMsR0FBR0MsU0FBUyxDQUFDQyxNQUFNLEVBQUVGLENBQUMsRUFBRSxFQUFFO0lBQUUsSUFBSUcsTUFBTSxHQUFHRixTQUFTLENBQUNELENB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