1bad8b0546ddca4fbc2008a04c815dc1
"use strict";

exports.__esModule = true;
exports.default = void 0;
var _Dimensions = _interopRequireDefault(require("../../exports/Dimensions"));
var _findNodeHandle = _interopRequireDefault(require("../../exports/findNodeHandle"));
var _invariant = _interopRequireDefault(require("fbjs/lib/invariant"));
var _Platform = _interopRequireDefault(require("../../exports/Platform"));
var _TextInputState = _interopRequireDefault(require("../TextInputState"));
var _UIManager = _interopRequireDefault(require("../../exports/UIManager"));
var _warning = _interopRequireDefault(require("fbjs/lib/warning"));
function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : {
    default: obj
  };
}
var emptyObject = {};
var IS_ANIMATING_TOUCH_START_THRESHOLD_MS = 16;
var ScrollResponderMixin = {
  scrollResponderMixinGetInitialState: function scrollResponderMixinGetInitialState() {
    return {
      isTouching: false,
      lastMomentumScrollBeginTime: 0,
      lastMomentumScrollEndTime: 0,
      observedScrollSinceBecomingResponder: false,
      becameResponderWhileAnimating: false
    };
  },
  scrollResponderHandleScrollShouldSetResponder: function scrollResponderHandleScrollShouldSetResponder() {
    return this.state.isTouching;
  },
  scrollResponderHandleStartShouldSetResponder: function scrollResponderHandleStartShouldSetResponder() {
    return false;
  },
  scrollResponderHandleStartShouldSetResponderCapture: function scrollResponderHandleStartShouldSetResponderCapture(e) {
    return this.scrollResponderIsAnimating();
  },
  scrollResponderHandleResponderReject: function scrollResponderHandleResponderReject() {
    (0, _warning.default)(false, "ScrollView doesn't take rejection well - scrolls anyway");
  },
  scrollResponderHandleTerminationRequest: function scrollResponderHandleTerminationRequest() {
    return !this.state.observedScrollSinceBecomingResponder;
  },
  scrollResponderHandleTouchEnd: function scrollResponderHandleTouchEnd(e) {
    var nativeEvent = e.nativeEvent;
    this.state.isTouching = nativeEvent.touches.length !== 0;
    this.props.onTouchEnd && this.props.onTouchEnd(e);
  },
  scrollResponderHandleResponderRelease: function scrollResponderHandleResponderRelease(e) {
    this.props.onResponderRelease && this.props.onResponderRelease(e);
    var currentlyFocusedTextInput = _TextInputState.default.currentlyFocusedField();
    if (!this.props.keyboardShouldPersistTaps && currentlyFocusedTextInput != null && e.target !== currentlyFocusedTextInput && !this.state.observedScrollSinceBecomingResponder && !this.state.becameResponderWhileAnimating) {
      this.props.onScrollResponderKeyboardDismissed && this.props.onScrollResponderKeyboardDismissed(e);
      _TextInputState.default.blurTextInput(currentlyFocusedTextInput);
    }
  },
  scrollResponderHandleScroll: function scrollResponderHandleScroll(e) {
    this.state.observedScrollSinceBecomingResponder = true;
    this.props.onScroll && this.props.onScroll(e);
  },
  scrollResponderHandleResponderGrant: function scrollResponderHandleResponderGrant(e) {
    this.state.observedScrollSinceBecomingResponder = false;
    this.props.onResponderGrant && this.props.onResponderGrant(e);
    this.state.becameResponderWhileAnimating = this.scrollResponderIsAnimating();
  },
  scrollResponderHandleScrollBeginDrag: function scrollResponderHandleScrollBeginDrag(e) {
    this.props.onScrollBeginDrag && this.props.onScrollBeginDrag(e);
  },
  scrollResponderHandleScrollEndDrag: function scrollResponderHandleScrollEndDrag(e) {
    this.props.onScrollEndDrag && this.props.onScrollEndDrag(e);
  },
  scrollResponderHandleMomentumScrollBegin: function scrollResponderHandleMomentumScrollBegin(e) {
    this.state.lastMomentumScrollBeginTime = Date.now();
    this.props.onMomentumScrollBegin && this.props.onMomentumScrollBegin(e);
  },
  scrollResponderHandleMomentumScrollEnd: function scrollResponderHandleMomentumScrollEnd(e) {
    this.state.lastMomentumScrollEndTime = Date.now();
    this.props.onMomentumScrollEnd && this.props.onMomentumScrollEnd(e);
  },
  scrollResponderHandleTouchStart: function scrollResponderHandleTouchStart(e) {
    this.state.isTouching = true;
    this.props.onTouchStart && this.props.onTouchStart(e);
  },
  scrollResponderHandleTouchMove: function scrollResponderHandleTouchMove(e) {
    this.props.onTouchMove && this.props.onTouchMove(e);
  },
  scrollResponderIsAnimating: function scrollResponderIsAnimating() {
    var now = Date.now();
    var timeSinceLastMomentumScrollEnd = now - this.state.lastMomentumScrollEndTime;
    var isAnimating = timeSinceLastMomentumScrollEnd < IS_ANIMATING_TOUCH_START_THRESHOLD_MS || this.state.lastMomentumScrollEndTime < this.state.lastMomentumScrollBeginTime;
    return isAnimating;
  },
  scrollResponderGetScrollableNode: function scrollResponderGetScrollableNode() {
    return this.getScrollableNode ? this.getScrollableNode() : (0, _findNodeHandle.default)(this);
  },
  scrollResponderScrollTo: function scrollResponderScrollTo(x, y, animated) {
    if (typeof x === 'number') {
      console.warn('`scrollResponderScrollTo(x, y, animated)` is deprecated. Use `scrollResponderScrollTo({x: 5, y: 5, animated: true})` instead.');
    } else {
      var _ref = x || emptyObject;
      x = _ref.x;
      y = _ref.y;
      animated = _ref.animated;
    }
    var node = this.scrollResponderGetScrollableNode();
    var left = x || 0;
    var top = y || 0;
    if (typeof node.scroll === 'function') {
      node.scroll({
        top: top,
        left: left,
        behavior: !animated ? 'auto' : 'smooth'
      });
    } else {
      node.scrollLeft = left;
      node.scrollTop = top;
    }
  },
  scrollResponderZoomTo: function scrollResponderZoomTo(rect, animated) {
    if (_Platform.default.OS !== 'ios') {
      (0, _invariant.default)('zoomToRect is not implemented');
    }
  },
  scrollResponderFlashScrollIndicators: function scrollResponderFlashScrollIndicators() {},
  scrollResponderScrollNativeHandleToKeyboard: function scrollResponderScrollNativeHandleToKeyboard(nodeHandle, additionalOffset, preventNegativeScrollOffset) {
    this.additionalScrollOffset = additionalOffset || 0;
    this.preventNegativeScrollOffset = !!preventNegativeScrollOffset;
    _UIManager.default.measureLayout(nodeHandle, (0, _findNodeHandle.default)(this.getInnerViewNode()), this.scrollResponderTextInputFocusError, this.scrollResponderInputMeasureAndScrollToKeyboard);
  },
  scrollResponderInputMeasureAndScrollToKeyboard: function scrollResponderInputMeasureAndScrollToKeyboard(left, top, width, height) {
    var keyboardScreenY = _Dimensions.default.get('window').height;
    if (this.keyboardWillOpenTo) {
      keyboardScreenY = this.keyboardWillOpenTo.endCoordinates.screenY;
    }
    var scrollOffsetY = top - keyboardScreenY + height + this.additionalScrollOffset;
    if (this.preventNegativeScrollOffset) {
      scrollOffsetY = Math.max(0, scrollOffsetY);
    }
    this.scrollResponderScrollTo({
      x: 0,
      y: scrollOffsetY,
      animated: true
    });
    this.additionalOffset = 0;
    this.preventNegativeScrollOffset = false;
  },
  scrollResponderTextInputFocusError: function scrollResponderTextInputFocusError(e) {
    console.error('Error measuring text field: ', e);
  },
  UNSAFE_componentWillMount: function UNSAFE_componentWillMount() {
    this.keyboardWillOpenTo = null;
    this.additionalScrollOffset = 0;
  },
  scrollResponderKeyboardWillShow: function scrollResponderKeyboardWillShow(e) {
    this.keyboardWillOpenTo = e;
    this.props.onKeyboardWillShow && this.props.onKeyboardWillShow(e);
  },
  scrollResponderKeyboardWillHide: function scrollResponderKeyboardWillHide(e) {
    this.keyboardWillOpenTo = null;
    this.props.onKeyboardWillHide && this.props.onKeyboardWillHide(e);
  },
  scrollResponderKeyboardDidShow: function scrollResponderKeyboardDidShow(e) {
    if (e) {
      this.keyboardWillOpenTo = e;
    }
    this.props.onKeyboardDidShow && this.props.onKeyboardDidShow(e);
  },
  scrollResponderKeyboardDidHide: function scrollResponderKeyboardDidHide(e) {
    this.keyboardWillOpenTo = null;
    this.props.onKeyboardDidHide && this.props.onKeyboardDidHide(e);
  }
};
var ScrollResponder = {
  Mixin: ScrollResponderMixin
};
var _default = ScrollResponder;
exports.default = _default;
module.exports = exports.default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHBvcnRzIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJfRGltZW5zaW9ucyIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiX2ZpbmROb2RlSGFuZGxlIiwiX2ludmFyaWFudCIsIl9QbGF0Zm9ybSIsIl9UZXh0SW5wdXRTdGF0ZSIsIl9VSU1hbmFnZXIiLCJfd2FybmluZyIsIm9iaiIsImVtcHR5T2JqZWN0IiwiSVNfQU5JTUFUSU5HX1RPVUNIX1NUQVJUX1RIUkVTSE9MRF9NUyIsIlNjcm9sbFJlc3BvbmRlck1peGluIiwic2Nyb2xsUmVzcG9uZGVyTWl4aW5HZXRJbml0aWFsU3RhdGUiLCJpc1RvdWNoaW5nIiwibGFzdE1vbWVudHVtU2Nyb2xsQmVnaW5UaW1lIiwibGFzdE1vbWVudHVtU2Nyb2xsRW5kVGltZSIsIm9ic2VydmVkU2Nyb2xsU2luY2VCZWNvbWluZ1Jlc3BvbmRlciIsImJlY2FtZVJlc3BvbmRlcldoaWxlQW5pbWF0aW5nIiwic2Nyb2xsUmVzcG9uZGVySGFuZGxlU2Nyb2xsU2hvdWxkU2V0UmVzcG9uZGVyIiwic3RhdGUiLCJzY3JvbGxSZXNwb25kZXJIYW5kbGVTdGFydFNob3VsZFNldFJlc3BvbmRlciIsInNjcm9sbFJlc3BvbmRlckhhbmRsZVN0YXJ0U2hvdWxkU2V0UmVzcG9uZGVyQ2FwdHVyZSIsImUiLCJzY3JvbGxSZXNwb25kZXJJc0FuaW1hdGluZyIsInNjcm9sbFJlc3BvbmRlckhhbmRsZVJlc3BvbmRlclJlamVjdCIsInNjcm9sbFJlc3BvbmRlckhhbmRsZVRlcm1pbmF0aW9uUmVxdWVzdCIsInNjcm9sbFJlc3BvbmRlckhhbmRsZVRvdWNoRW5kIiwibmF0aXZlRXZlbnQiLCJ0b3VjaGVzIiwibGVuZ3RoIiwicHJvcHMiLCJvblRvdWNoRW5kIiwic2Nyb2xsUmVzcG9uZGVySGFuZGxlUmVzcG9uZGVyUmVsZWFzZSIsIm9uUmVzcG9uZGVyUmVsZWFzZSIsImN1cnJlbnRseUZvY3VzZWRUZXh0SW5wdXQiLCJjdXJyZW50bHlGb2N1c2VkRmllbGQiLCJrZXlib2FyZFNob3VsZFBlcnNpc3RUYXBzIiwidGFyZ2V0Iiwib25TY3JvbGxSZXNwb25kZXJLZXlib2FyZERpc21pc3NlZCIsImJsdXJUZXh0SW5wdXQiLCJzY3JvbGxSZXNwb25kZXJIYW5kbGVTY3JvbGwiLCJvblNjcm9sbCIsInNjcm9sbFJlc3BvbmRlckhhbmRsZVJlc3BvbmRlckdyYW50Iiwib25SZXNwb25kZXJHcmFudCIsInNjcm9sbFJlc3BvbmRlckhhbmRsZVNjcm9sbEJlZ2luRHJhZyIsIm9uU2Nyb2xsQmVnaW5EcmFnIiwic2Nyb2xsUmVzcG9uZGVySGFuZGxlU2Nyb2xsRW5kRHJhZyIsIm9uU2Nyb2xsRW5kRHJhZyIsInNjcm9sbFJlc3BvbmRlckhhbmRsZU1vbWVudHVtU2Nyb2xsQmVnaW4iLCJEYXRlIiwibm93Iiwib25Nb21lbnR1bVNjcm9sbEJlZ2luIiwic2Nyb2xsUmVzcG9uZGVySGFuZGxlTW9tZW50dW1TY3JvbGxFbmQiLCJvbk1vbWVudHVtU2Nyb2xsRW5kIiwic2Nyb2xsUmVzcG9uZGVySGFuZGxlVG91Y2hTdGFydCIsIm9uVG91Y2hTdGFydCIsInNjcm9sbFJlc3BvbmRlckhhbmRsZVRvdWNoTW92ZSIsIm9uVG91Y2hNb3ZlIiwidGltZVNpbmNlTGFzdE1vbWVudHVtU2Nyb2xsRW5kIiwiaXNBbmltYXRpbmciLCJzY3JvbGxSZXNwb25kZXJHZXRTY3JvbGxhYmxlTm9kZSIsImdldFNjcm9sbGFibGVOb2RlIiwic2Nyb2xsUmVzcG9uZGVyU2Nyb2xsVG8iLCJ4IiwieSIsImFuaW1hdGVkIiwiY29uc29sZSIsIndhcm4iLCJfcmVmIiwibm9kZSIsImxlZnQiLCJ0b3AiLCJzY3JvbGwiLCJiZWhhdmlvciIsInNjcm9sbExlZnQiLCJzY3JvbGxUb3AiLCJzY3JvbGxSZXNwb25kZXJab29tVG8iLCJyZWN0IiwiT1MiLCJzY3JvbGxSZXNwb25kZXJGbGFzaFNjcm9sbEluZGljYXRvcnMiLCJzY3JvbGxSZXNwb25kZXJTY3JvbGxOYXRpdmVIYW5kbGVUb0tleWJvYXJkIiwibm9kZUhhbmRsZSIsImFkZGl0aW9uYWxPZmZzZXQiLCJwcmV2ZW50TmVnYXRpdmVTY3JvbGxPZmZzZXQiLCJhZGRpdGlvbmFsU2Nyb2xsT2Zmc2V0IiwibWVhc3VyZUxheW91dCIsImdldElubmVyVmlld05vZGUiLCJzY3JvbGxSZXNwb25kZXJUZXh0SW5wdXRGb2N1c0Vycm9yIiwic2Nyb2xsUmVzcG9uZGVySW5wdXRNZWFzdXJlQW5kU2Nyb2xsVG9LZXlib2FyZCIsIndpZHRoIiwiaGVpZ2h0Iiwia2V5Ym9hcmRTY3JlZW5ZIiwiZ2V0Iiwia2V5Ym9hcmRXaWxsT3BlblRvIiwiZW5kQ29vcmRpbmF0ZXMiLCJzY3JlZW5ZIiwic2Nyb2xsT2Zmc2V0WSIsIk1hdGgiLCJtYXgiLCJlcnJvciIsIlVOU0FGRV9jb21wb25lbnRXaWxsTW91bnQiLCJzY3JvbGxSZXNwb25kZXJLZXlib2FyZFdpbGxTaG93Iiwib25LZXlib2FyZFdpbGxTaG93Iiwic2Nyb2xsUmVzcG9uZGVyS2V5Ym9hcmRXaWxsSGlkZSIsIm9uS2V5Ym9hcmRXaWxsSGlkZSIsInNjcm9sbFJlc3BvbmRlcktleWJvYXJkRGlkU2hvdyIsIm9uS2V5Ym9hcmREaWRTaG93Iiwic2Nyb2xsUmVzcG9uZGVyS2V5Ym9hcmREaWRIaWRlIiwib25LZXlib2FyZERpZEhpZGUiLCJTY3JvbGxSZXNwb25kZXIiLCJNaXhpbiIsIl9kZWZhdWx0IiwibW9kdWxlIl0sInNvdXJjZXMiOlsiaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cbmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7XG5leHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7XG5cbnZhciBfRGltZW5zaW9ucyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4uLy4uL2V4cG9ydHMvRGltZW5zaW9uc1wiKSk7XG5cbnZhciBfZmluZE5vZGVIYW5kbGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuLi8uLi9leHBvcnRzL2ZpbmROb2RlSGFuZGxlXCIpKTtcblxudmFyIF9pbnZhcmlhbnQgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJmYmpzL2xpYi9pbnZhcmlhbnRcIikpO1xuXG52YXIgX1BsYXRmb3JtID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi4vLi4vZXhwb3J0cy9QbGF0Zm9ybVwiKSk7XG5cbnZhciBfVGV4dElucHV0U3RhdGUgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuLi9UZXh0SW5wdXRTdGF0ZVwiKSk7XG5cbnZhciBfVUlNYW5hZ2VyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi4vLi4vZXhwb3J0cy9VSU1hbmFnZXJcIikpO1xuXG52YXIgX3dhcm5pbmcgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJmYmpzL2xpYi93YXJuaW5nXCIpKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuLyoqXG4gKiBDb3B5cmlnaHQgKGMpIE5pY29sYXMgR2FsbGFnaGVyLlxuICogQ29weXJpZ2h0IChjKSBGYWNlYm9vaywgSW5jLiBhbmQgaXRzIGFmZmlsaWF0ZXMuXG4gKlxuICogVGhpcyBzb3VyY2UgY29kZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UgZm91bmQgaW4gdGhlXG4gKiBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoaXMgc291cmNlIHRyZWUuXG4gKlxuICogXG4gKi9cblxuLyoqXG4gKiBNaXhpbiB0aGF0IGNhbiBiZSBpbnRlZ3JhdGVkIGluIG9yZGVyIHRvIGhhbmRsZSBzY3JvbGxpbmcgdGhhdCBwbGF5cyB3ZWxsXG4gKiB3aXRoIGBSZXNwb25kZXJFdmVudFBsdWdpbmAuIEludGVncmF0ZSB3aXRoIHlvdXIgcGxhdGZvcm0gc3BlY2lmaWMgc2Nyb2xsXG4gKiB2aWV3cywgb3IgZXZlbiB5b3VyIGN1c3RvbSBidWlsdCAoZXZlcnktZnJhbWUgYW5pbWF0aW5nKSBzY3JvbGwgdmlld3Mgc28gdGhhdFxuICogYWxsIG9mIHRoZXNlIHN5c3RlbXMgcGxheSB3ZWxsIHdpdGggdGhlIGBSZXNwb25kZXJFdmVudFBsdWdpbmAuXG4gKlxuICogaU9TIHNjcm9sbCBldmVudCB0aW1pbmcgbnVhbmNlczpcbiAqID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAqXG4gKlxuICogU2Nyb2xsaW5nIHdpdGhvdXQgYm91bmNpbmcsIGlmIHlvdSB0b3VjaCBkb3duOlxuICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICpcbiAqIDEuIGBvbk1vbWVudHVtU2Nyb2xsQmVnaW5gICh3aGVuIGFuaW1hdGlvbiBiZWdpbnMgYWZ0ZXIgbGV0dGluZyB1cClcbiAqICAgIC4uLiBwaHlzaWNhbCB0b3VjaCBzdGFydHMgLi4uXG4gKiAyLiBgb25Ub3VjaFN0YXJ0Q2FwdHVyZWAgICAod2hlbiB5b3UgcHJlc3MgZG93biB0byBzdG9wIHRoZSBzY3JvbGwpXG4gKiAzLiBgb25Ub3VjaFN0YXJ0YCAgICAgICAgICAoc2FtZSwgYnV0IGJ1YmJsZSBwaGFzZSlcbiAqIDQuIGBvblJlc3BvbmRlclJlbGVhc2VgICAgICh3aGVuIGxpZnRpbmcgdXAgLSB5b3UgY291bGQgcGF1c2UgZm9yZXZlciBiZWZvcmUgKiBsaWZ0aW5nKVxuICogNS4gYG9uTW9tZW50dW1TY3JvbGxFbmRgXG4gKlxuICpcbiAqIFNjcm9sbGluZyB3aXRoIGJvdW5jaW5nLCBpZiB5b3UgdG91Y2ggZG93bjpcbiAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAqXG4gKiAxLiBgb25Nb21lbnR1bVNjcm9sbEJlZ2luYCAod2hlbiBhbmltYXRpb24gYmVnaW5zIGFmdGVyIGxldHRpbmcgdXApXG4gKiAgICAuLi4gYm91bmNlIGJlZ2lucyAuLi5cbiAqICAgIC4uLiBzb21lIHRpbWUgZWxhcHNlcyAuLi5cbiAqICAgIC4uLiBwaHlzaWNhbCB0b3VjaCBkdXJpbmcgYm91bmNlIC4uLlxuICogMi4gYG9uTW9tZW50dW1TY3JvbGxFbmRgICAgKE1ha2VzIG5vIHNlbnNlIHdoeSB0aGlzIG9jY3VycyBmaXJzdCBkdXJpbmcgYm91bmNlKVxuICogMy4gYG9uVG91Y2hTdGFydENhcHR1cmVgICAgKGltbWVkaWF0ZWx5IGFmdGVyIGBvbk1vbWVudHVtU2Nyb2xsRW5kYClcbiAqIDQuIGBvblRvdWNoU3RhcnRgICAgICAgICAgIChzYW1lLCBidXQgYnViYmxlIHBoYXNlKVxuICogNS4gYG9uVG91Y2hFbmRgICAgICAgICAgICAgKFlvdSBjb3VsZCBob2xkIHRoZSB0b3VjaCBzdGFydCBmb3IgYSBsb25nIHRpbWUpXG4gKiA2LiBgb25Nb21lbnR1bVNjcm9sbEJlZ2luYCAoV2hlbiByZWxlYXNpbmcgdGhlIHZpZXcgc3RhcnRzIGJvdW5jaW5nIGJhY2spXG4gKlxuICogU28gd2hlbiB3ZSByZWNlaXZlIGFuIGBvblRvdWNoU3RhcnRgLCBob3cgY2FuIHdlIHRlbGwgaWYgd2UgYXJlIHRvdWNoaW5nXG4gKiAqZHVyaW5nKiBhbiBhbmltYXRpb24gKHdoaWNoIHRoZW4gY2F1c2VzIHRoZSBhbmltYXRpb24gdG8gc3RvcCk/IFRoZSBvbmx5IHdheVxuICogdG8gdGVsbCBpcyBpZiB0aGUgYHRvdWNoU3RhcnRgIG9jY3VycmVkIGltbWVkaWF0ZWx5IGFmdGVyIHRoZVxuICogYG9uTW9tZW50dW1TY3JvbGxFbmRgLlxuICpcbiAqIFRoaXMgaXMgYWJzdHJhY3RlZCBvdXQgZm9yIHlvdSwgc28geW91IGNhbiBqdXN0IGNhbGwgdGhpcy5zY3JvbGxSZXNwb25kZXJJc0FuaW1hdGluZygpIGlmXG4gKiBuZWNlc3NhcnlcbiAqXG4gKiBgU2Nyb2xsUmVzcG9uZGVyYCBhbHNvIGluY2x1ZGVzIGxvZ2ljIGZvciBibHVycmluZyBhIGN1cnJlbnRseSBmb2N1c2VkIGlucHV0XG4gKiBpZiBvbmUgaXMgZm9jdXNlZCB3aGlsZSBzY3JvbGxpbmcuIFRoZSBgU2Nyb2xsUmVzcG9uZGVyYCBpcyBhIG5hdHVyYWwgcGxhY2VcbiAqIHRvIHB1dCB0aGlzIGxvZ2ljIHNpbmNlIGl0IGNhbiBzdXBwb3J0IG5vdCBkaXNtaXNzaW5nIHRoZSBrZXlib2FyZCB3aGlsZVxuICogc2Nyb2xsaW5nLCB1bmxlc3MgYSByZWNvZ25pemVkIFwidGFwXCItbGlrZSBnZXN0dXJlIGhhcyBvY2N1cnJlZC5cbiAqXG4gKiBUaGUgcHVibGljIGxpZmVjeWNsZSBBUEkgaW5jbHVkZXMgZXZlbnRzIGZvciBrZXlib2FyZCBpbnRlcmFjdGlvbiwgcmVzcG9uZGVyXG4gKiBpbnRlcmFjdGlvbiwgYW5kIHNjcm9sbGluZyAoYW1vbmcgb3RoZXJzKS4gVGhlIGtleWJvYXJkIGNhbGxiYWNrc1xuICogYG9uS2V5Ym9hcmRXaWxsL0RpZC8qYCBhcmUgKmdsb2JhbCogZXZlbnRzLCBidXQgYXJlIGludm9rZWQgb24gc2Nyb2xsXG4gKiByZXNwb25kZXIncyBwcm9wcyBzbyB0aGF0IHlvdSBjYW4gZ3VhcmFudGVlIHRoYXQgdGhlIHNjcm9sbCByZXNwb25kZXInc1xuICogaW50ZXJuYWwgc3RhdGUgaGFzIGJlZW4gdXBkYXRlZCBhY2NvcmRpbmdseSAoYW5kIGRldGVybWluaXN0aWNhbGx5KSBieVxuICogdGhlIHRpbWUgdGhlIHByb3BzIGNhbGxiYWNrcyBhcmUgaW52b2tlLiBPdGhlcndpc2UsIHlvdSB3b3VsZCBhbHdheXMgd29uZGVyXG4gKiBpZiB0aGUgc2Nyb2xsIHJlc3BvbmRlciBpcyBjdXJyZW50bHkgaW4gYSBzdGF0ZSB3aGVyZSBpdCByZWNvZ25pemVzIG5ld1xuICoga2V5Ym9hcmQgcG9zaXRpb25zIGV0Yy4gSWYgY29vcmRpbmF0aW5nIHNjcm9sbGluZyB3aXRoIGtleWJvYXJkIG1vdmVtZW50LFxuICogKmFsd2F5cyogdXNlIHRoZXNlIGhvb2tzIGluc3RlYWQgb2YgbGlzdGVuaW5nIHRvIHlvdXIgb3duIGdsb2JhbCBrZXlib2FyZFxuICogZXZlbnRzLlxuICpcbiAqIFB1YmxpYyBrZXlib2FyZCBsaWZlY3ljbGUgQVBJOiAocHJvcHMgY2FsbGJhY2tzKVxuICpcbiAqIFN0YW5kYXJkIEtleWJvYXJkIEFwcGVhcmFuY2UgU2VxdWVuY2U6XG4gKlxuICogICB0aGlzLnByb3BzLm9uS2V5Ym9hcmRXaWxsU2hvd1xuICogICB0aGlzLnByb3BzLm9uS2V5Ym9hcmREaWRTaG93XG4gKlxuICogYG9uU2Nyb2xsUmVzcG9uZGVyS2V5Ym9hcmREaXNtaXNzZWRgIHdpbGwgYmUgaW52b2tlZCBpZiBhbiBhcHByb3ByaWF0ZVxuICogdGFwIGluc2lkZSB0aGUgc2Nyb2xsIHJlc3BvbmRlcidzIHNjcm9sbGFibGUgcmVnaW9uIHdhcyByZXNwb25zaWJsZVxuICogZm9yIHRoZSBkaXNtaXNzYWwgb2YgdGhlIGtleWJvYXJkLiBUaGVyZSBhcmUgb3RoZXIgcmVhc29ucyB3aHkgdGhlXG4gKiBrZXlib2FyZCBjb3VsZCBiZSBkaXNtaXNzZWQuXG4gKlxuICogICB0aGlzLnByb3BzLm9uU2Nyb2xsUmVzcG9uZGVyS2V5Ym9hcmREaXNtaXNzZWRcbiAqXG4gKiBTdGFuZGFyZCBLZXlib2FyZCBIaWRlIFNlcXVlbmNlOlxuICpcbiAqICAgdGhpcy5wcm9wcy5vbktleWJvYXJkV2lsbEhpZGVcbiAqICAgdGhpcy5wcm9wcy5vbktleWJvYXJkRGlkSGlkZVxuICovXG52YXIgZW1wdHlPYmplY3QgPSB7fTtcbnZhciBJU19BTklNQVRJTkdfVE9VQ0hfU1RBUlRfVEhSRVNIT0xEX01TID0gMTY7XG52YXIgU2Nyb2xsUmVzcG9uZGVyTWl4aW4gPSB7XG4gIC8vIG1peGluczogW1N1YnNjcmliYWJsZS5NaXhpbl0sXG4gIHNjcm9sbFJlc3BvbmRlck1peGluR2V0SW5pdGlhbFN0YXRlOiBmdW5jdGlvbiBzY3JvbGxSZXNwb25kZXJNaXhpbkdldEluaXRpYWxTdGF0ZSgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgaXNUb3VjaGluZzogZmFsc2UsXG4gICAgICBsYXN0TW9tZW50dW1TY3JvbGxCZWdpblRpbWU6IDAsXG4gICAgICBsYXN0TW9tZW50dW1TY3JvbGxFbmRUaW1lOiAwLFxuICAgICAgLy8gUmVzZXQgdG8gZmFsc2UgZXZlcnkgdGltZSBiZWNvbWVzIHJlc3BvbmRlci4gVGhpcyBpcyB1c2VkIHRvOlxuICAgICAgLy8gLSBEZXRlcm1pbmUgaWYgdGhlIHNjcm9sbCB2aWV3IGhhcyBiZWVuIHNjcm9sbGVkIGFuZCB0aGVyZWZvcmUgc2hvdWxkXG4gICAgICAvLyByZWZ1c2UgdG8gZ2l2ZSB1cCBpdHMgcmVzcG9uZGVyIGxvY2suXG4gICAgICAvLyAtIERldGVybWluZSBpZiByZWxlYXNpbmcgc2hvdWxkIGRpc21pc3MgdGhlIGtleWJvYXJkIHdoZW4gd2UgYXJlIGluXG4gICAgICAvLyB0YXAtdG8tZGlzbWlzcyBtb2RlICghdGhpcy5wcm9wcy5rZXlib2FyZFNob3VsZFBlcnNpc3RUYXBzKS5cbiAgICAgIG9ic2VydmVkU2Nyb2xsU2luY2VCZWNvbWluZ1Jlc3BvbmRlcjogZmFsc2UsXG4gICAgICBiZWNhbWVSZXNwb25kZXJXaGlsZUFuaW1hdGluZzogZmFsc2VcbiAgICB9O1xuICB9LFxuXG4gIC8qKlxuICAgKiBJbnZva2UgdGhpcyBmcm9tIGFuIGBvblNjcm9sbGAgZXZlbnQuXG4gICAqL1xuICBzY3JvbGxSZXNwb25kZXJIYW5kbGVTY3JvbGxTaG91bGRTZXRSZXNwb25kZXI6IGZ1bmN0aW9uIHNjcm9sbFJlc3BvbmRlckhhbmRsZVNjcm9sbFNob3VsZFNldFJlc3BvbmRlcigpIHtcbiAgICByZXR1cm4gdGhpcy5zdGF0ZS5pc1RvdWNoaW5nO1xuICB9LFxuXG4gIC8qKlxuICAgKiBNZXJlbHkgdG91Y2ggc3RhcnRpbmcgaXMgbm90IHN1ZmZpY2llbnQgZm9yIGEgc2Nyb2xsIHZpZXcgdG8gYmVjb21lIHRoZVxuICAgKiByZXNwb25kZXIuIEJlaW5nIHRoZSBcInJlc3BvbmRlclwiIG1lYW5zIHRoYXQgdGhlIHZlcnkgbmV4dCB0b3VjaCBtb3ZlL2VuZFxuICAgKiBldmVudCB3aWxsIHJlc3VsdCBpbiBhbiBhY3Rpb24vbW92ZW1lbnQuXG4gICAqXG4gICAqIEludm9rZSB0aGlzIGZyb20gYW4gYG9uU3RhcnRTaG91bGRTZXRSZXNwb25kZXJgIGV2ZW50LlxuICAgKlxuICAgKiBgb25TdGFydFNob3VsZFNldFJlc3BvbmRlcmAgaXMgdXNlZCB3aGVuIHRoZSBuZXh0IG1vdmUvZW5kIHdpbGwgdHJpZ2dlclxuICAgKiBzb21lIFVJIG1vdmVtZW50L2FjdGlvbiwgYnV0IHdoZW4geW91IHdhbnQgdG8geWllbGQgcHJpb3JpdHkgdG8gdmlld3NcbiAgICogbmVzdGVkIGluc2lkZSBvZiB0aGUgdmlldy5cbiAgICpcbiAgICogVGhlcmUgbWF5IGJlIHNvbWUgY2FzZXMgd2hlcmUgc2Nyb2xsIHZpZXdzIGFjdHVhbGx5IHNob3VsZCByZXR1cm4gYHRydWVgXG4gICAqIGZyb20gYG9uU3RhcnRTaG91bGRTZXRSZXNwb25kZXJgOiBBbnkgdGltZSB3ZSBhcmUgZGV0ZWN0aW5nIGEgc3RhbmRhcmQgdGFwXG4gICAqIHRoYXQgZ2l2ZXMgcHJpb3JpdHkgdG8gbmVzdGVkIHZpZXdzLlxuICAgKlxuICAgKiAtIElmIGEgc2luZ2xlIHRhcCBvbiB0aGUgc2Nyb2xsIHZpZXcgdHJpZ2dlcnMgYW4gYWN0aW9uIHN1Y2ggYXNcbiAgICogICByZWNlbnRlcmluZyBhIG1hcCBzdHlsZSB2aWV3IHlldCB3YW50cyB0byBnaXZlIHByaW9yaXR5IHRvIGludGVyYWN0aW9uXG4gICAqICAgdmlld3MgaW5zaWRlIChzdWNoIGFzIGRyb3BwZWQgcGlucyBvciBsYWJlbHMpLCB0aGVuIHdlIHdvdWxkIHJldHVybiB0cnVlXG4gICAqICAgZnJvbSB0aGlzIG1ldGhvZCB3aGVuIHRoZXJlIGlzIGEgc2luZ2xlIHRvdWNoLlxuICAgKlxuICAgKiAtIFNpbWlsYXIgdG8gdGhlIHByZXZpb3VzIGNhc2UsIGlmIGEgdHdvIGZpbmdlciBcInRhcFwiIHNob3VsZCB0cmlnZ2VyIGFcbiAgICogICB6b29tLCB3ZSB3b3VsZCBjaGVjayB0aGUgYHRvdWNoZXNgIGNvdW50LCBhbmQgaWYgYD49IDJgLCB3ZSB3b3VsZCByZXR1cm5cbiAgICogICB0cnVlLlxuICAgKlxuICAgKi9cbiAgc2Nyb2xsUmVzcG9uZGVySGFuZGxlU3RhcnRTaG91bGRTZXRSZXNwb25kZXI6IGZ1bmN0aW9uIHNjcm9sbFJlc3BvbmRlckhhbmRsZVN0YXJ0U2hvdWxkU2V0UmVzcG9uZGVyKCkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfSxcblxuICAvKipcbiAgICogVGhlcmUgYXJlIHRpbWVzIHdoZW4gdGhlIHNjcm9sbCB2aWV3IHdhbnRzIHRvIGJlY29tZSB0aGUgcmVzcG9uZGVyXG4gICAqIChtZWFuaW5nIHJlc3BvbmQgdG8gdGhlIG5leHQgaW1tZWRpYXRlIGB0b3VjaFN0YXJ0L3RvdWNoRW5kYCksIGluIGEgd2F5XG4gICAqIHRoYXQgKmRvZXNuJ3QqIGdpdmUgcHJpb3JpdHkgdG8gbmVzdGVkIHZpZXdzIChoZW5jZSB0aGUgY2FwdHVyZSBwaGFzZSk6XG4gICAqXG4gICAqIC0gQ3VycmVudGx5IGFuaW1hdGluZy5cbiAgICogLSBUYXBwaW5nIGFueXdoZXJlIHRoYXQgaXMgbm90IHRoZSBmb2N1c2VkIGlucHV0LCB3aGlsZSB0aGUga2V5Ym9hcmQgaXNcbiAgICogICB1cCAod2hpY2ggc2hvdWxkIGRpc21pc3MgdGhlIGtleWJvYXJkKS5cbiAgICpcbiAgICogSW52b2tlIHRoaXMgZnJvbSBhbiBgb25TdGFydFNob3VsZFNldFJlc3BvbmRlckNhcHR1cmVgIGV2ZW50LlxuICAgKi9cbiAgc2Nyb2xsUmVzcG9uZGVySGFuZGxlU3RhcnRTaG91bGRTZXRSZXNwb25kZXJDYXB0dXJlOiBmdW5jdGlvbiBzY3JvbGxSZXNwb25kZXJIYW5kbGVTdGFydFNob3VsZFNldFJlc3BvbmRlckNhcHR1cmUoZSkge1xuICAgIC8vIEZpcnN0IHNlZSBpZiB3ZSB3YW50IHRvIGVhdCB0YXBzIHdoaWxlIHRoZSBrZXlib2FyZCBpcyB1cFxuICAgIC8vIHZhciBjdXJyZW50bHlGb2N1c2VkVGV4dElucHV0ID0gVGV4dElucHV0U3RhdGUuY3VycmVudGx5Rm9jdXNlZEZpZWxkKCk7XG4gICAgLy8gaWYgKCF0aGlzLnByb3BzLmtleWJvYXJkU2hvdWxkUGVyc2lzdFRhcHMgJiZcbiAgICAvLyAgIGN1cnJlbnRseUZvY3VzZWRUZXh0SW5wdXQgIT0gbnVsbCAmJlxuICAgIC8vICAgZS50YXJnZXQgIT09IGN1cnJlbnRseUZvY3VzZWRUZXh0SW5wdXQpIHtcbiAgICAvLyAgIHJldHVybiB0cnVlO1xuICAgIC8vIH1cbiAgICByZXR1cm4gdGhpcy5zY3JvbGxSZXNwb25kZXJJc0FuaW1hdGluZygpO1xuICB9LFxuXG4gIC8qKlxuICAgKiBJbnZva2UgdGhpcyBmcm9tIGFuIGBvblJlc3BvbmRlclJlamVjdGAgZXZlbnQuXG4gICAqXG4gICAqIFNvbWUgb3RoZXIgZWxlbWVudCBpcyBub3QgeWllbGRpbmcgaXRzIHJvbGUgYXMgcmVzcG9uZGVyLiBOb3JtYWxseSwgd2UnZFxuICAgKiBqdXN0IGRpc2FibGUgdGhlIGBVSVNjcm9sbFZpZXdgLCBidXQgYSB0b3VjaCBoYXMgYWxyZWFkeSBiZWdhbiBvbiBpdCwgdGhlXG4gICAqIGBVSVNjcm9sbFZpZXdgIHdpbGwgbm90IGFjY2VwdCBiZWluZyBkaXNhYmxlZCBhZnRlciB0aGF0LiBUaGUgZWFzaWVzdFxuICAgKiBzb2x1dGlvbiBmb3Igbm93IGlzIHRvIGFjY2VwdCB0aGUgbGltaXRhdGlvbiBvZiBkaXNhbGxvd2luZyB0aGlzXG4gICAqIGFsdG9nZXRoZXIuIFRvIGltcHJvdmUgdGhpcywgZmluZCBhIHdheSB0byBkaXNhYmxlIHRoZSBgVUlTY3JvbGxWaWV3YCBhZnRlclxuICAgKiBhIHRvdWNoIGhhcyBhbHJlYWR5IHN0YXJ0ZWQuXG4gICAqL1xuICBzY3JvbGxSZXNwb25kZXJIYW5kbGVSZXNwb25kZXJSZWplY3Q6IGZ1bmN0aW9uIHNjcm9sbFJlc3BvbmRlckhhbmRsZVJlc3BvbmRlclJlamVjdCgpIHtcbiAgICAoMCwgX3dhcm5pbmcuZGVmYXVsdCkoZmFsc2UsIFwiU2Nyb2xsVmlldyBkb2Vzbid0IHRha2UgcmVqZWN0aW9uIHdlbGwgLSBzY3JvbGxzIGFueXdheVwiKTtcbiAgfSxcblxuICAvKipcbiAgICogV2Ugd2lsbCBhbGxvdyB0aGUgc2Nyb2xsIHZpZXcgdG8gZ2l2ZSB1cCBpdHMgbG9jayBpZmYgaXQgYWNxdWlyZWQgdGhlIGxvY2tcbiAgICogZHVyaW5nIGFuIGFuaW1hdGlvbi4gVGhpcyBpcyBhIHZlcnkgdXNlZnVsIGRlZmF1bHQgdGhhdCBoYXBwZW5zIHRvIHNhdGlzZnlcbiAgICogbWFueSBjb21tb24gdXNlciBleHBlcmllbmNlcy5cbiAgICpcbiAgICogLSBTdG9wIGEgc2Nyb2xsIG9uIHRoZSBsZWZ0IGVkZ2UsIHRoZW4gdHVybiB0aGF0IGludG8gYW4gb3V0ZXIgdmlldydzXG4gICAqICAgYmFja3N3aXBlLlxuICAgKiAtIFN0b3AgYSBzY3JvbGwgbWlkLWJvdW5jZSBhdCB0aGUgdG9wLCBjb250aW51ZSBwdWxsaW5nIHRvIGhhdmUgdGhlIG91dGVyXG4gICAqICAgdmlldyBkaXNtaXNzLlxuICAgKiAtIEhvd2V2ZXIsIHdpdGhvdXQgY2F0Y2hpbmcgdGhlIHNjcm9sbCB2aWV3IG1pZC1ib3VuY2UgKHdoaWxlIGl0IGlzXG4gICAqICAgbW90aW9ubGVzcyksIGlmIHlvdSBkcmFnIGZhciBlbm91Z2ggZm9yIHRoZSBzY3JvbGwgdmlldyB0byBiZWNvbWVcbiAgICogICByZXNwb25kZXIgKGFuZCB0aGVyZWZvcmUgZHJhZyB0aGUgc2Nyb2xsIHZpZXcgYSBiaXQpLCBhbnkgYmFja3N3aXBlXG4gICAqICAgbmF2aWdhdGlvbiBvZiBhIHN3aXBlIGdlc3R1cmUgaGlnaGVyIGluIHRoZSB2aWV3IGhpZXJhcmNoeSwgc2hvdWxkIGJlXG4gICAqICAgcmVqZWN0ZWQuXG4gICAqL1xuICBzY3JvbGxSZXNwb25kZXJIYW5kbGVUZXJtaW5hdGlvblJlcXVlc3Q6IGZ1bmN0aW9uIHNjcm9sbFJlc3BvbmRlckhhbmRsZVRlcm1pbmF0aW9uUmVxdWVzdCgpIHtcbiAgICByZXR1cm4gIXRoaXMuc3RhdGUub2JzZXJ2ZWRTY3JvbGxTaW5jZUJlY29taW5nUmVzcG9uZGVyO1xuICB9LFxuXG4gIC8qKlxuICAgKiBJbnZva2UgdGhpcyBmcm9tIGFuIGBvblRvdWNoRW5kYCBldmVudC5cbiAgICpcbiAgICogQHBhcmFtIHtTeW50aGV0aWNFdmVudH0gZSBFdmVudC5cbiAgICovXG4gIHNjcm9sbFJlc3BvbmRlckhhbmRsZVRvdWNoRW5kOiBmdW5jdGlvbiBzY3JvbGxSZXNwb25kZXJIYW5kbGVUb3VjaEVuZChlKSB7XG4gICAgdmFyIG5hdGl2ZUV2ZW50ID0gZS5uYXRpdmVFdmVudDtcbiAgICB0aGlzLnN0YXRlLmlzVG91Y2hpbmcgPSBuYXRpdmVFdmVudC50b3VjaGVzLmxlbmd0aCAhPT0gMDtcbiAgICB0aGlzLnByb3BzLm9uVG91Y2hFbmQgJiYgdGhpcy5wcm9wcy5vblRvdWNoRW5kKGUpO1xuICB9LFxuXG4gIC8qKlxuICAgKiBJbnZva2UgdGhpcyBmcm9tIGFuIGBvblJlc3BvbmRlclJlbGVhc2VgIGV2ZW50LlxuICAgKi9cbiAgc2Nyb2xsUmVzcG9uZGVySGFuZGxlUmVzcG9uZGVyUmVsZWFzZTogZnVuY3Rpb24gc2Nyb2xsUmVzcG9uZGVySGFuZGxlUmVzcG9uZGVyUmVsZWFzZShlKSB7XG4gICAgdGhpcy5wcm9wcy5vblJlc3BvbmRlclJlbGVhc2UgJiYgdGhpcy5wcm9wcy5vblJlc3BvbmRlclJlbGVhc2UoZSk7IC8vIEJ5IGRlZmF1bHQgc2Nyb2xsIHZpZXdzIHdpbGwgdW5mb2N1cyBhIHRleHRGaWVsZFxuICAgIC8vIGlmIGFub3RoZXIgdG91Y2ggb2NjdXJzIG91dHNpZGUgb2YgaXRcblxuICAgIHZhciBjdXJyZW50bHlGb2N1c2VkVGV4dElucHV0ID0gX1RleHRJbnB1dFN0YXRlLmRlZmF1bHQuY3VycmVudGx5Rm9jdXNlZEZpZWxkKCk7XG5cbiAgICBpZiAoIXRoaXMucHJvcHMua2V5Ym9hcmRTaG91bGRQZXJzaXN0VGFwcyAmJiBjdXJyZW50bHlGb2N1c2VkVGV4dElucHV0ICE9IG51bGwgJiYgZS50YXJnZXQgIT09IGN1cnJlbnRseUZvY3VzZWRUZXh0SW5wdXQgJiYgIXRoaXMuc3RhdGUub2JzZXJ2ZWRTY3JvbGxTaW5jZUJlY29taW5nUmVzcG9uZGVyICYmICF0aGlzLnN0YXRlLmJlY2FtZVJlc3BvbmRlcldoaWxlQW5pbWF0aW5nKSB7XG4gICAgICB0aGlzLnByb3BzLm9uU2Nyb2xsUmVzcG9uZGVyS2V5Ym9hcmREaXNtaXNzZWQgJiYgdGhpcy5wcm9wcy5vblNjcm9sbFJlc3BvbmRlcktleWJvYXJkRGlzbWlzc2VkKGUpO1xuXG4gICAgICBfVGV4dElucHV0U3RhdGUuZGVmYXVsdC5ibHVyVGV4dElucHV0KGN1cnJlbnRseUZvY3VzZWRUZXh0SW5wdXQpO1xuICAgIH1cbiAgfSxcbiAgc2Nyb2xsUmVzcG9uZGVySGFuZGxlU2Nyb2xsOiBmdW5jdGlvbiBzY3JvbGxSZXNwb25kZXJIYW5kbGVTY3JvbGwoZSkge1xuICAgIHRoaXMuc3RhdGUub2JzZXJ2ZWRTY3JvbGxTaW5jZUJlY29taW5nUmVzcG9uZGVyID0gdHJ1ZTtcbiAgICB0aGlzLnByb3BzLm9uU2Nyb2xsICYmIHRoaXMucHJvcHMub25TY3JvbGwoZSk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIEludm9rZSB0aGlzIGZyb20gYW4gYG9uUmVzcG9uZGVyR3JhbnRgIGV2ZW50LlxuICAgKi9cbiAgc2Nyb2xsUmVzcG9uZGVySGFuZGxlUmVzcG9uZGVyR3JhbnQ6IGZ1bmN0aW9uIHNjcm9sbFJlc3BvbmRlckhhbmRsZVJlc3BvbmRlckdyYW50KGUpIHtcbiAgICB0aGlzLnN0YXRlLm9ic2VydmVkU2Nyb2xsU2luY2VCZWNvbWluZ1Jlc3BvbmRlciA9IGZhbHNlO1xuICAgIHRoaXMucHJvcHMub25SZXNwb25kZXJHcmFudCAmJiB0aGlzLnByb3BzLm9uUmVzcG9uZGVyR3JhbnQoZSk7XG4gICAgdGhpcy5zdGF0ZS5iZWNhbWVSZXNwb25kZXJXaGlsZUFuaW1hdGluZyA9IHRoaXMuc2Nyb2xsUmVzcG9uZGVySXNBbmltYXRpbmcoKTtcbiAgfSxcblxuICAvKipcbiAgICogVW5mb3J0dW5hdGVseSwgYG9uU2Nyb2xsQmVnaW5EcmFnYCBhbHNvIGZpcmVzIHdoZW4gKnN0b3BwaW5nKiB0aGUgc2Nyb2xsXG4gICAqIGFuaW1hdGlvbiwgYW5kIHRoZXJlJ3Mgbm90IGFuIGVhc3kgd2F5IHRvIGRpc3Rpbmd1aXNoIGEgZHJhZyB2cy4gc3RvcHBpbmdcbiAgICogbW9tZW50dW0uXG4gICAqXG4gICAqIEludm9rZSB0aGlzIGZyb20gYW4gYG9uU2Nyb2xsQmVnaW5EcmFnYCBldmVudC5cbiAgICovXG4gIHNjcm9sbFJlc3BvbmRlckhhbmRsZVNjcm9sbEJlZ2luRHJhZzogZnVuY3Rpb24gc2Nyb2xsUmVzcG9uZGVySGFuZGxlU2Nyb2xsQmVnaW5EcmFnKGUpIHtcbiAgICB0aGlzLnByb3BzLm9uU2Nyb2xsQmVnaW5EcmFnICYmIHRoaXMucHJvcHMub25TY3JvbGxCZWdpbkRyYWcoZSk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIEludm9rZSB0aGlzIGZyb20gYW4gYG9uU2Nyb2xsRW5kRHJhZ2AgZXZlbnQuXG4gICAqL1xuICBzY3JvbGxSZXNwb25kZXJIYW5kbGVTY3JvbGxFbmREcmFnOiBmdW5jdGlvbiBzY3JvbGxSZXNwb25kZXJIYW5kbGVTY3JvbGxFbmREcmFnKGUpIHtcbiAgICB0aGlzLnByb3BzLm9uU2Nyb2xsRW5kRHJhZyAmJiB0aGlzLnByb3BzLm9uU2Nyb2xsRW5kRHJhZyhlKTtcbiAgfSxcblxuICAvKipcbiAgICogSW52b2tlIHRoaXMgZnJvbSBhbiBgb25Nb21lbnR1bVNjcm9sbEJlZ2luYCBldmVudC5cbiAgICovXG4gIHNjcm9sbFJlc3BvbmRlckhhbmRsZU1vbWVudHVtU2Nyb2xsQmVnaW46IGZ1bmN0aW9uIHNjcm9sbFJlc3BvbmRlckhhbmRsZU1vbWVudHVtU2Nyb2xsQmVnaW4oZSkge1xuICAgIHRoaXMuc3RhdGUubGFzdE1vbWVudHVtU2Nyb2xsQmVnaW5UaW1lID0gRGF0ZS5ub3coKTtcbiAgICB0aGlzLnByb3BzLm9uTW9tZW50dW1TY3JvbGxCZWdpbiAmJiB0aGlzLnByb3BzLm9uTW9tZW50dW1TY3JvbGxCZWdpbihlKTtcbiAgfSxcblxuICAvKipcbiAgICogSW52b2tlIHRoaXMgZnJvbSBhbiBgb25Nb21lbnR1bVNjcm9sbEVuZGAgZXZlbnQuXG4gICAqL1xuICBzY3JvbGxSZXNwb25kZXJIYW5kbGVNb21lbnR1bVNjcm9sbEVuZDogZnVuY3Rpb24gc2Nyb2xsUmVzcG9uZGVySGFuZGxlTW9tZW50dW1TY3JvbGxFbmQoZSkge1xuICAgIHRoaXMuc3RhdGUubGFzdE1vbWVudHVtU2Nyb2xsRW5kVGltZSA9IERhdGUubm93KCk7XG4gICAgdGhpcy5wcm9wcy5vbk1vbWVudHVtU2Nyb2xsRW5kICYmIHRoaXMucHJvcHMub25Nb21lbnR1bVNjcm9sbEVuZChlKTtcbiAgfSxcblxuICAvKipcbiAgICogSW52b2tlIHRoaXMgZnJvbSBhbiBgb25Ub3VjaFN0YXJ0YCBldmVudC5cbiAgICpcbiAgICogU2luY2Ugd2Uga25vdyB0aGF0IHRoZSBgU2ltcGxlRXZlbnRQbHVnaW5gIG9jY3VycyBsYXRlciBpbiB0aGUgcGx1Z2luXG4gICAqIG9yZGVyLCBhZnRlciBgUmVzcG9uZGVyRXZlbnRQbHVnaW5gLCB3ZSBjYW4gZGV0ZWN0IHRoYXQgd2Ugd2VyZSAqbm90KlxuICAgKiBwZXJtaXR0ZWQgdG8gYmUgdGhlIHJlc3BvbmRlciAocHJlc3VtYWJseSBiZWNhdXNlIGEgY29udGFpbmVkIHZpZXcgYmVjYW1lXG4gICAqIHJlc3BvbmRlcikuIFRoZSBgb25SZXNwb25kZXJSZWplY3RgIHdvbid0IGZpcmUgaW4gdGhhdCBjYXNlIC0gaXQgb25seVxuICAgKiBmaXJlcyB3aGVuIGEgKmN1cnJlbnQqIHJlc3BvbmRlciByZWplY3RzIG91ciByZXF1ZXN0LlxuICAgKlxuICAgKiBAcGFyYW0ge1N5bnRoZXRpY0V2ZW50fSBlIFRvdWNoIFN0YXJ0IGV2ZW50LlxuICAgKi9cbiAgc2Nyb2xsUmVzcG9uZGVySGFuZGxlVG91Y2hTdGFydDogZnVuY3Rpb24gc2Nyb2xsUmVzcG9uZGVySGFuZGxlVG91Y2hTdGFydChlKSB7XG4gICAgdGhpcy5zdGF0ZS5pc1RvdWNoaW5nID0gdHJ1ZTtcbiAgICB0aGlzLnByb3BzLm9uVG91Y2hTdGFydCAmJiB0aGlzLnByb3BzLm9uVG91Y2hTdGFydChlKTtcbiAgfSxcblxuICAvKipcbiAgICogSW52b2tlIHRoaXMgZnJvbSBhbiBgb25Ub3VjaE1vdmVgIGV2ZW50LlxuICAgKlxuICAgKiBTaW5jZSB3ZSBrbm93IHRoYXQgdGhlIGBTaW1wbGVFdmVudFBsdWdpbmAgb2NjdXJzIGxhdGVyIGluIHRoZSBwbHVnaW5cbiAgICogb3JkZXIsIGFmdGVyIGBSZXNwb25kZXJFdmVudFBsdWdpbmAsIHdlIGNhbiBkZXRlY3QgdGhhdCB3ZSB3ZXJlICpub3QqXG4gICAqIHBlcm1pdHRlZCB0byBiZSB0aGUgcmVzcG9uZGVyIChwcmVzdW1hYmx5IGJlY2F1c2UgYSBjb250YWluZWQgdmlldyBiZWNhbWVcbiAgICogcmVzcG9uZGVyKS4gVGhlIGBvblJlc3BvbmRlclJlamVjdGAgd29uJ3QgZmlyZSBpbiB0aGF0IGNhc2UgLSBpdCBvbmx5XG4gICAqIGZpcmVzIHdoZW4gYSAqY3VycmVudCogcmVzcG9uZGVyIHJlamVjdHMgb3VyIHJlcXVlc3QuXG4gICAqXG4gICAqIEBwYXJhbSB7U3ludGhldGljRXZlbnR9IGUgVG91Y2ggU3RhcnQgZXZlbnQuXG4gICAqL1xuICBzY3JvbGxSZXNwb25kZXJIYW5kbGVUb3VjaE1vdmU6IGZ1bmN0aW9uIHNjcm9sbFJlc3BvbmRlckhhbmRsZVRvdWNoTW92ZShlKSB7XG4gICAgdGhpcy5wcm9wcy5vblRvdWNoTW92ZSAmJiB0aGlzLnByb3BzLm9uVG91Y2hNb3ZlKGUpO1xuICB9LFxuXG4gIC8qKlxuICAgKiBBIGhlbHBlciBmdW5jdGlvbiBmb3IgdGhpcyBjbGFzcyB0aGF0IGxldHMgdXMgcXVpY2tseSBkZXRlcm1pbmUgaWYgdGhlXG4gICAqIHZpZXcgaXMgY3VycmVudGx5IGFuaW1hdGluZy4gVGhpcyBpcyBwYXJ0aWN1bGFybHkgdXNlZnVsIHRvIGtub3cgd2hlblxuICAgKiBhIHRvdWNoIGhhcyBqdXN0IHN0YXJ0ZWQgb3IgZW5kZWQuXG4gICAqL1xuICBzY3JvbGxSZXNwb25kZXJJc0FuaW1hdGluZzogZnVuY3Rpb24gc2Nyb2xsUmVzcG9uZGVySXNBbmltYXRpbmcoKSB7XG4gICAgdmFyIG5vdyA9IERhdGUubm93KCk7XG4gICAgdmFyIHRpbWVTaW5jZUxhc3RNb21lbnR1bVNjcm9sbEVuZCA9IG5vdyAtIHRoaXMuc3RhdGUubGFzdE1vbWVudHVtU2Nyb2xsRW5kVGltZTtcbiAgICB2YXIgaXNBbmltYXRpbmcgPSB0aW1lU2luY2VMYXN0TW9tZW50dW1TY3JvbGxFbmQgPCBJU19BTklNQVRJTkdfVE9VQ0hfU1RBUlRfVEhSRVNIT0xEX01TIHx8IHRoaXMuc3RhdGUubGFzdE1vbWVudHVtU2Nyb2xsRW5kVGltZSA8IHRoaXMuc3RhdGUubGFzdE1vbWVudHVtU2Nyb2xsQmVnaW5UaW1lO1xuICAgIHJldHVybiBpc0FuaW1hdGluZztcbiAgfSxcblxuICAvKipcbiAgICogUmV0dXJucyB0aGUgbm9kZSB0aGF0IHJlcHJlc2VudHMgbmF0aXZlIHZpZXcgdGhhdCBjYW4gYmUgc2Nyb2xsZWQuXG4gICAqIENvbXBvbmVudHMgY2FuIHBhc3Mgd2hhdCBub2RlIHRvIHVzZSBieSBkZWZpbmluZyBhIGBnZXRTY3JvbGxhYmxlTm9kZWBcbiAgICogZnVuY3Rpb24gb3RoZXJ3aXNlIGB0aGlzYCBpcyB1c2VkLlxuICAgKi9cbiAgc2Nyb2xsUmVzcG9uZGVyR2V0U2Nyb2xsYWJsZU5vZGU6IGZ1bmN0aW9uIHNjcm9sbFJlc3BvbmRlckdldFNjcm9sbGFibGVOb2RlKCkge1xuICAgIHJldHVybiB0aGlzLmdldFNjcm9sbGFibGVOb2RlID8gdGhpcy5nZXRTY3JvbGxhYmxlTm9kZSgpIDogKDAsIF9maW5kTm9kZUhhbmRsZS5kZWZhdWx0KSh0aGlzKTtcbiAgfSxcblxuICAvKipcbiAgICogQSBoZWxwZXIgZnVuY3Rpb24gdG8gc2Nyb2xsIHRvIGEgc3BlY2lmaWMgcG9pbnQgaW4gdGhlIHNjcm9sbHZpZXcuXG4gICAqIFRoaXMgaXMgY3VycmVudGx5IHVzZWQgdG8gaGVscCBmb2N1cyBvbiBjaGlsZCB0ZXh0dmlld3MsIGJ1dCBjYW4gYWxzb1xuICAgKiBiZSB1c2VkIHRvIHF1aWNrbHkgc2Nyb2xsIHRvIGFueSBlbGVtZW50IHdlIHdhbnQgdG8gZm9jdXMuIFN5bnRheDpcbiAgICpcbiAgICogc2Nyb2xsUmVzcG9uZGVyU2Nyb2xsVG8ob3B0aW9uczoge3g6IG51bWJlciA9IDA7IHk6IG51bWJlciA9IDA7IGFuaW1hdGVkOiBib29sZWFuID0gdHJ1ZX0pXG4gICAqXG4gICAqIE5vdGU6IFRoZSB3ZWlyZCBhcmd1bWVudCBzaWduYXR1cmUgaXMgZHVlIHRvIHRoZSBmYWN0IHRoYXQsIGZvciBoaXN0b3JpY2FsIHJlYXNvbnMsXG4gICAqIHRoZSBmdW5jdGlvbiBhbHNvIGFjY2VwdHMgc2VwYXJhdGUgYXJndW1lbnRzIGFzIGFzIGFsdGVybmF0aXZlIHRvIHRoZSBvcHRpb25zIG9iamVjdC5cbiAgICogVGhpcyBpcyBkZXByZWNhdGVkIGR1ZSB0byBhbWJpZ3VpdHkgKHkgYmVmb3JlIHgpLCBhbmQgU0hPVUxEIE5PVCBCRSBVU0VELlxuICAgKi9cbiAgc2Nyb2xsUmVzcG9uZGVyU2Nyb2xsVG86IGZ1bmN0aW9uIHNjcm9sbFJlc3BvbmRlclNjcm9sbFRvKHgsIHksIGFuaW1hdGVkKSB7XG4gICAgaWYgKHR5cGVvZiB4ID09PSAnbnVtYmVyJykge1xuICAgICAgY29uc29sZS53YXJuKCdgc2Nyb2xsUmVzcG9uZGVyU2Nyb2xsVG8oeCwgeSwgYW5pbWF0ZWQpYCBpcyBkZXByZWNhdGVkLiBVc2UgYHNjcm9sbFJlc3BvbmRlclNjcm9sbFRvKHt4OiA1LCB5OiA1LCBhbmltYXRlZDogdHJ1ZX0pYCBpbnN0ZWFkLicpO1xuICAgIH0gZWxzZSB7XG4gICAgICB2YXIgX3JlZiA9IHggfHwgZW1wdHlPYmplY3Q7XG5cbiAgICAgIHggPSBfcmVmLng7XG4gICAgICB5ID0gX3JlZi55O1xuICAgICAgYW5pbWF0ZWQgPSBfcmVmLmFuaW1hdGVkO1xuICAgIH1cblxuICAgIHZhciBub2RlID0gdGhpcy5zY3JvbGxSZXNwb25kZXJHZXRTY3JvbGxhYmxlTm9kZSgpO1xuICAgIHZhciBsZWZ0ID0geCB8fCAwO1xuICAgIHZhciB0b3AgPSB5IHx8IDA7XG5cbiAgICBpZiAodHlwZW9mIG5vZGUuc2Nyb2xsID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICBub2RlLnNjcm9sbCh7XG4gICAgICAgIHRvcDogdG9wLFxuICAgICAgICBsZWZ0OiBsZWZ0LFxuICAgICAgICBiZWhhdmlvcjogIWFuaW1hdGVkID8gJ2F1dG8nIDogJ3Ntb290aCdcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBub2RlLnNjcm9sbExlZnQgPSBsZWZ0O1xuICAgICAgbm9kZS5zY3JvbGxUb3AgPSB0b3A7XG4gICAgfVxuICB9LFxuXG4gIC8qKlxuICAgKiBBIGhlbHBlciBmdW5jdGlvbiB0byB6b29tIHRvIGEgc3BlY2lmaWMgcmVjdCBpbiB0aGUgc2Nyb2xsdmlldy4gVGhlIGFyZ3VtZW50IGhhcyB0aGUgc2hhcGVcbiAgICoge3g6IG51bWJlcjsgeTogbnVtYmVyOyB3aWR0aDogbnVtYmVyOyBoZWlnaHQ6IG51bWJlcjsgYW5pbWF0ZWQ6IGJvb2xlYW4gPSB0cnVlfVxuICAgKlxuICAgKiBAcGxhdGZvcm0gaW9zXG4gICAqL1xuICBzY3JvbGxSZXNwb25kZXJab29tVG86IGZ1bmN0aW9uIHNjcm9sbFJlc3BvbmRlclpvb21UbyhyZWN0LCBhbmltYXRlZCkgLy8gZGVwcmVjYXRlZCwgcHV0IHRoaXMgaW5zaWRlIHRoZSByZWN0IGFyZ3VtZW50IGluc3RlYWRcbiAge1xuICAgIGlmIChfUGxhdGZvcm0uZGVmYXVsdC5PUyAhPT0gJ2lvcycpIHtcbiAgICAgICgwLCBfaW52YXJpYW50LmRlZmF1bHQpKCd6b29tVG9SZWN0IGlzIG5vdCBpbXBsZW1lbnRlZCcpO1xuICAgIH1cbiAgfSxcblxuICAvKipcbiAgICogRGlzcGxheXMgdGhlIHNjcm9sbCBpbmRpY2F0b3JzIG1vbWVudGFyaWx5LlxuICAgKi9cbiAgc2Nyb2xsUmVzcG9uZGVyRmxhc2hTY3JvbGxJbmRpY2F0b3JzOiBmdW5jdGlvbiBzY3JvbGxSZXNwb25kZXJGbGFzaFNjcm9sbEluZGljYXRvcnMoKSB7fSxcblxuICAvKipcbiAgICogVGhpcyBtZXRob2Qgc2hvdWxkIGJlIHVzZWQgYXMgdGhlIGNhbGxiYWNrIHRvIG9uRm9jdXMgaW4gYSBUZXh0SW5wdXRzJ1xuICAgKiBwYXJlbnQgdmlldy4gTm90ZSB0aGF0IGFueSBtb2R1bGUgdXNpbmcgdGhpcyBtaXhpbiBuZWVkcyB0byByZXR1cm5cbiAgICogdGhlIHBhcmVudCB2aWV3J3MgcmVmIGluIGdldFNjcm9sbFZpZXdSZWYoKSBpbiBvcmRlciB0byB1c2UgdGhpcyBtZXRob2QuXG4gICAqIEBwYXJhbSB7YW55fSBub2RlSGFuZGxlIFRoZSBUZXh0SW5wdXQgbm9kZSBoYW5kbGVcbiAgICogQHBhcmFtIHtudW1iZXJ9IGFkZGl0aW9uYWxPZmZzZXQgVGhlIHNjcm9sbCB2aWV3J3MgdG9wIFwiY29udGVudEluc2V0XCIuXG4gICAqICAgICAgICBEZWZhdWx0IGlzIDAuXG4gICAqIEBwYXJhbSB7Ym9vbH0gcHJldmVudE5lZ2F0aXZlU2Nyb2xsaW5nIFdoZXRoZXIgdG8gYWxsb3cgcHVsbGluZyB0aGUgY29udGVudFxuICAgKiAgICAgICAgZG93biB0byBtYWtlIGl0IG1lZXQgdGhlIGtleWJvYXJkJ3MgdG9wLiBEZWZhdWx0IGlzIGZhbHNlLlxuICAgKi9cbiAgc2Nyb2xsUmVzcG9uZGVyU2Nyb2xsTmF0aXZlSGFuZGxlVG9LZXlib2FyZDogZnVuY3Rpb24gc2Nyb2xsUmVzcG9uZGVyU2Nyb2xsTmF0aXZlSGFuZGxlVG9LZXlib2FyZChub2RlSGFuZGxlLCBhZGRpdGlvbmFsT2Zmc2V0LCBwcmV2ZW50TmVnYXRpdmVTY3JvbGxPZmZzZXQpIHtcbiAgICB0aGlzLmFkZGl0aW9uYWxTY3JvbGxPZmZzZXQgPSBhZGRpdGlvbmFsT2Zmc2V0IHx8IDA7XG4gICAgdGhpcy5wcmV2ZW50TmVnYXRpdmVTY3JvbGxPZmZzZXQgPSAhIXByZXZlbnROZWdhdGl2ZVNjcm9sbE9mZnNldDtcblxuICAgIF9VSU1hbmFnZXIuZGVmYXVsdC5tZWFzdXJlTGF5b3V0KG5vZGVIYW5kbGUsICgwLCBfZmluZE5vZGVIYW5kbGUuZGVmYXVsdCkodGhpcy5nZXRJbm5lclZpZXdOb2RlKCkpLCB0aGlzLnNjcm9sbFJlc3BvbmRlclRleHRJbnB1dEZvY3VzRXJyb3IsIHRoaXMuc2Nyb2xsUmVzcG9uZGVySW5wdXRNZWFzdXJlQW5kU2Nyb2xsVG9LZXlib2FyZCk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIFRoZSBjYWxjdWxhdGlvbnMgcGVyZm9ybWVkIGhlcmUgYXNzdW1lIHRoZSBzY3JvbGwgdmlldyB0YWtlcyB1cCB0aGUgZW50aXJlXG4gICAqIHNjcmVlbiAtIGV2ZW4gaWYgaGFzIHNvbWUgY29udGVudCBpbnNldC4gV2UgdGhlbiBtZWFzdXJlIHRoZSBvZmZzZXRzIG9mIHRoZVxuICAgKiBrZXlib2FyZCwgYW5kIGNvbXBlbnNhdGUgYm90aCBmb3IgdGhlIHNjcm9sbCB2aWV3J3MgXCJjb250ZW50SW5zZXRcIi5cbiAgICpcbiAgICogQHBhcmFtIHtudW1iZXJ9IGxlZnQgUG9zaXRpb24gb2YgaW5wdXQgdy5yLnQuIHRhYmxlIHZpZXcuXG4gICAqIEBwYXJhbSB7bnVtYmVyfSB0b3AgUG9zaXRpb24gb2YgaW5wdXQgdy5yLnQuIHRhYmxlIHZpZXcuXG4gICAqIEBwYXJhbSB7bnVtYmVyfSB3aWR0aCBXaWR0aCBvZiB0aGUgdGV4dCBpbnB1dC5cbiAgICogQHBhcmFtIHtudW1iZXJ9IGhlaWdodCBIZWlnaHQgb2YgdGhlIHRleHQgaW5wdXQuXG4gICAqL1xuICBzY3JvbGxSZXNwb25kZXJJbnB1dE1lYXN1cmVBbmRTY3JvbGxUb0tleWJvYXJkOiBmdW5jdGlvbiBzY3JvbGxSZXNwb25kZXJJbnB1dE1lYXN1cmVBbmRTY3JvbGxUb0tleWJvYXJkKGxlZnQsIHRvcCwgd2lkdGgsIGhlaWdodCkge1xuICAgIHZhciBrZXlib2FyZFNjcmVlblkgPSBfRGltZW5zaW9ucy5kZWZhdWx0LmdldCgnd2luZG93JykuaGVpZ2h0O1xuXG4gICAgaWYgKHRoaXMua2V5Ym9hcmRXaWxsT3BlblRvKSB7XG4gICAgICBrZXlib2FyZFNjcmVlblkgPSB0aGlzLmtleWJvYXJkV2lsbE9wZW5Uby5lbmRDb29yZGluYXRlcy5zY3JlZW5ZO1xuICAgIH1cblxuICAgIHZhciBzY3JvbGxPZmZzZXRZID0gdG9wIC0ga2V5Ym9hcmRTY3JlZW5ZICsgaGVpZ2h0ICsgdGhpcy5hZGRpdGlvbmFsU2Nyb2xsT2Zmc2V0OyAvLyBCeSBkZWZhdWx0LCB0aGlzIGNhbiBzY3JvbGwgd2l0aCBuZWdhdGl2ZSBvZmZzZXQsIHB1bGxpbmcgdGhlIGNvbnRlbnRcbiAgICAvLyBkb3duIHNvIHRoYXQgdGhlIHRhcmdldCBjb21wb25lbnQncyBib3R0b20gbWVldHMgdGhlIGtleWJvYXJkJ3MgdG9wLlxuICAgIC8vIElmIHJlcXVlc3RlZCBvdGhlcndpc2UsIGNhcCB0aGUgb2Zmc2V0IGF0IDAgbWluaW11bSB0byBhdm9pZCBjb250ZW50XG4gICAgLy8gc2hpZnRpbmcgZG93bi5cblxuICAgIGlmICh0aGlzLnByZXZlbnROZWdhdGl2ZVNjcm9sbE9mZnNldCkge1xuICAgICAgc2Nyb2xsT2Zmc2V0WSA9IE1hdGgubWF4KDAsIHNjcm9sbE9mZnNldFkpO1xuICAgIH1cblxuICAgIHRoaXMuc2Nyb2xsUmVzcG9uZGVyU2Nyb2xsVG8oe1xuICAgICAgeDogMCxcbiAgICAgIHk6IHNjcm9sbE9mZnNldFksXG4gICAgICBhbmltYXRlZDogdHJ1ZVxuICAgIH0pO1xuICAgIHRoaXMuYWRkaXRpb25hbE9mZnNldCA9IDA7XG4gICAgdGhpcy5wcmV2ZW50TmVnYXRpdmVTY3JvbGxPZmZzZXQgPSBmYWxzZTtcbiAgfSxcbiAgc2Nyb2xsUmVzcG9uZGVyVGV4dElucHV0Rm9jdXNFcnJvcjogZnVuY3Rpb24gc2Nyb2xsUmVzcG9uZGVyVGV4dElucHV0Rm9jdXNFcnJvcihlKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgbWVhc3VyaW5nIHRleHQgZmllbGQ6ICcsIGUpO1xuICB9LFxuXG4gIC8qKlxuICAgKiBgY29tcG9uZW50V2lsbE1vdW50YCBpcyB0aGUgY2xvc2VzdCB0aGluZyB0byBhICBzdGFuZGFyZCBcImNvbnN0cnVjdG9yXCIgZm9yXG4gICAqIFJlYWN0IGNvbXBvbmVudHMuXG4gICAqXG4gICAqIFRoZSBga2V5Ym9hcmRXaWxsU2hvd2AgaXMgY2FsbGVkIGJlZm9yZSBpbnB1dCBmb2N1cy5cbiAgICovXG4gIFVOU0FGRV9jb21wb25lbnRXaWxsTW91bnQ6IGZ1bmN0aW9uIFVOU0FGRV9jb21wb25lbnRXaWxsTW91bnQoKSB7XG4gICAgdGhpcy5rZXlib2FyZFdpbGxPcGVuVG8gPSBudWxsO1xuICAgIHRoaXMuYWRkaXRpb25hbFNjcm9sbE9mZnNldCA9IDA7IC8vIHRoaXMuYWRkTGlzdGVuZXJPbihSQ1REZXZpY2VFdmVudEVtaXR0ZXIsICdrZXlib2FyZFdpbGxTaG93JywgdGhpcy5zY3JvbGxSZXNwb25kZXJLZXlib2FyZFdpbGxTaG93KTtcbiAgICAvLyB0aGlzLmFkZExpc3RlbmVyT24oUkNURGV2aWNlRXZlbnRFbWl0dGVyLCAna2V5Ym9hcmRXaWxsSGlkZScsIHRoaXMuc2Nyb2xsUmVzcG9uZGVyS2V5Ym9hcmRXaWxsSGlkZSk7XG4gICAgLy8gdGhpcy5hZGRMaXN0ZW5lck9uKFJDVERldmljZUV2ZW50RW1pdHRlciwgJ2tleWJvYXJkRGlkU2hvdycsIHRoaXMuc2Nyb2xsUmVzcG9uZGVyS2V5Ym9hcmREaWRTaG93KTtcbiAgICAvLyB0aGlzLmFkZExpc3RlbmVyT24oUkNURGV2aWNlRXZlbnRFbWl0dGVyLCAna2V5Ym9hcmREaWRIaWRlJywgdGhpcy5zY3JvbGxSZXNwb25kZXJLZXlib2FyZERpZEhpZGUpO1xuICB9LFxuXG4gIC8qKlxuICAgKiBXYXJuaW5nLCB0aGlzIG1heSBiZSBjYWxsZWQgc2V2ZXJhbCB0aW1lcyBmb3IgYSBzaW5nbGUga2V5Ym9hcmQgb3BlbmluZy5cbiAgICogSXQncyBiZXN0IHRvIHN0b3JlIHRoZSBpbmZvcm1hdGlvbiBpbiB0aGlzIG1ldGhvZCBhbmQgdGhlbiB0YWtlIGFueSBhY3Rpb25cbiAgICogYXQgYSBsYXRlciBwb2ludCAoZWl0aGVyIGluIGBrZXlib2FyZERpZFNob3dgIG9yIG90aGVyKS5cbiAgICpcbiAgICogSGVyZSdzIHRoZSBvcmRlciB0aGF0IGV2ZW50cyBvY2N1ciBpbjpcbiAgICogLSBmb2N1c1xuICAgKiAtIHdpbGxTaG93IHtzdGFydENvb3JkaW5hdGVzLCBlbmRDb29yZGluYXRlc30gc2V2ZXJhbCB0aW1lc1xuICAgKiAtIGRpZFNob3cgc2V2ZXJhbCB0aW1lc1xuICAgKiAtIGJsdXJcbiAgICogLSB3aWxsSGlkZSB7c3RhcnRDb29yZGluYXRlcywgZW5kQ29vcmRpbmF0ZXN9IHNldmVyYWwgdGltZXNcbiAgICogLSBkaWRIaWRlIHNldmVyYWwgdGltZXNcbiAgICpcbiAgICogVGhlIGBTY3JvbGxSZXNwb25kZXJgIHByb3ZpZGVzTW9kdWxlIGNhbGxiYWNrcyBmb3IgZWFjaCBvZiB0aGVzZSBldmVudHMuXG4gICAqIEV2ZW4gdGhvdWdoIGFueSB1c2VyIGNvdWxkIGhhdmUgZWFzaWx5IGxpc3RlbmVkIHRvIGtleWJvYXJkIGV2ZW50c1xuICAgKiB0aGVtc2VsdmVzLCB1c2luZyB0aGVzZSBgcHJvcHNgIGNhbGxiYWNrcyBlbnN1cmVzIHRoYXQgb3JkZXJpbmcgb2YgZXZlbnRzXG4gICAqIGlzIGNvbnNpc3RlbnQgLSBhbmQgbm90IGRlcGVuZGVudCBvbiB0aGUgb3JkZXIgdGhhdCB0aGUga2V5Ym9hcmQgZXZlbnRzIGFyZVxuICAgKiBzdWJzY3JpYmVkIHRvLiBUaGlzIG1hdHRlcnMgd2hlbiB0ZWxsaW5nIHRoZSBzY3JvbGwgdmlldyB0byBzY3JvbGwgdG8gd2hlcmVcbiAgICogdGhlIGtleWJvYXJkIGlzIGhlYWRlZCAtIHRoZSBzY3JvbGwgcmVzcG9uZGVyIGJldHRlciBoYXZlIGJlZW4gbm90aWZpZWQgb2ZcbiAgICogdGhlIGtleWJvYXJkIGRlc3RpbmF0aW9uIGJlZm9yZSBiZWluZyBpbnN0cnVjdGVkIHRvIHNjcm9sbCB0byB3aGVyZSB0aGVcbiAgICoga2V5Ym9hcmQgd2lsbCBiZS4gU3RpY2sgdG8gdGhlIGBTY3JvbGxSZXNwb25kZXJgIGNhbGxiYWNrcywgYW5kIGV2ZXJ5dGhpbmdcbiAgICogd2lsbCB3b3JrLlxuICAgKlxuICAgKiBXQVJOSU5HOiBUaGVzZSBjYWxsYmFja3Mgd2lsbCBmaXJlIGV2ZW4gaWYgYSBrZXlib2FyZCBpcyBkaXNwbGF5ZWQgaW4gYVxuICAgKiBkaWZmZXJlbnQgbmF2aWdhdGlvbiBwYW5lLiBGaWx0ZXIgb3V0IHRoZSBldmVudHMgdG8gZGV0ZXJtaW5lIGlmIHRoZXkgYXJlXG4gICAqIHJlbGV2YW50IHRvIHlvdS4gKEZvciBleGFtcGxlLCBvbmx5IGlmIHlvdSByZWNlaXZlIHRoZXNlIGNhbGxiYWNrcyBhZnRlclxuICAgKiB5b3UgaGFkIGV4cGxpY2l0bHkgZm9jdXNlZCBhIG5vZGUgZXRjKS5cbiAgICovXG4gIHNjcm9sbFJlc3BvbmRlcktleWJvYXJkV2lsbFNob3c6IGZ1bmN0aW9uIHNjcm9sbFJlc3BvbmRlcktleWJvYXJkV2lsbFNob3coZSkge1xuICAgIHRoaXMua2V5Ym9hcmRXaWxsT3BlblRvID0gZTtcbiAgICB0aGlzLnByb3BzLm9uS2V5Ym9hcmRXaWxsU2hvdyAmJiB0aGlzLnByb3BzLm9uS2V5Ym9hcmRXaWxsU2hvdyhlKTtcbiAgfSxcbiAgc2Nyb2xsUmVzcG9uZGVyS2V5Ym9hcmRXaWxsSGlkZTogZnVuY3Rpb24gc2Nyb2xsUmVzcG9uZGVyS2V5Ym9hcmRXaWxsSGlkZShlKSB7XG4gICAgdGhpcy5rZXlib2FyZFdpbGxPcGVuVG8gPSBudWxsO1xuICAgIHRoaXMucHJvcHMub25LZXlib2FyZFdpbGxIaWRlICYmIHRoaXMucHJvcHMub25LZXlib2FyZFdpbGxIaWRlKGUpO1xuICB9LFxuICBzY3JvbGxSZXNwb25kZXJLZXlib2FyZERpZFNob3c6IGZ1bmN0aW9uIHNjcm9sbFJlc3BvbmRlcktleWJvYXJkRGlkU2hvdyhlKSB7XG4gICAgLy8gVE9ETyg3NjkzOTYxKTogVGhlIGV2ZW50IGZvciBEaWRTaG93IGlzIG5vdCBhdmFpbGFibGUgb24gaU9TIHlldC5cbiAgICAvLyBVc2UgdGhlIG9uZSBmcm9tIFdpbGxTaG93IGFuZCBkbyBub3QgYXNzaWduLlxuICAgIGlmIChlKSB7XG4gICAgICB0aGlzLmtleWJvYXJkV2lsbE9wZW5UbyA9IGU7XG4gICAgfVxuXG4gICAgdGhpcy5wcm9wcy5vbktleWJvYXJkRGlkU2hvdyAmJiB0aGlzLnByb3BzLm9uS2V5Ym9hcmREaWRTaG93KGUpO1xuICB9LFxuICBzY3JvbGxSZXNwb25kZXJLZXlib2FyZERpZEhpZGU6IGZ1bmN0aW9uIHNjcm9sbFJlc3BvbmRlcktleWJvYXJkRGlkSGlkZShlKSB7XG4gICAgdGhpcy5rZXlib2FyZFdpbGxPcGVuVG8gPSBudWxsO1xuICAgIHRoaXMucHJvcHMub25LZXlib2FyZERpZEhpZGUgJiYgdGhpcy5wcm9wcy5vbktleWJvYXJkRGlkSGlkZShlKTtcbiAgfVxufTtcbnZhciBTY3JvbGxSZXNwb25kZXIgPSB7XG4gIE1peGluOiBTY3JvbGxSZXNwb25kZXJNaXhpblxufTtcbnZhciBfZGVmYXVsdCA9IFNjcm9sbFJlc3BvbmRlcjtcbmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0O1xubW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzLmRlZmF1bHQ7Il0sIm1hcHBpbmdzIjoiQUFBQSxZQUFZOztBQUVaQSxPQUFPLENB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