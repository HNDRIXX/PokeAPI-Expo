c8ce7bee8839e0ae864fe7c1f4114581
"use strict";

exports.__esModule = true;
exports.default = useEvent;
var _createEventHandle = _interopRequireDefault(require("../createEventHandle"));
var _useLayoutEffect = _interopRequireDefault(require("../useLayoutEffect"));
var _useStable = _interopRequireDefault(require("../useStable"));
function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : {
    default: obj
  };
}
function useEvent(event, options) {
  var targetListeners = (0, _useStable.default)(function () {
    return new Map();
  });
  var addListener = (0, _useStable.default)(function () {
    var addEventListener = (0, _createEventHandle.default)(event, options);
    return function (target, callback) {
      var removeTargetListener = targetListeners.get(target);
      if (removeTargetListener != null) {
        removeTargetListener();
      }
      if (callback == null) {
        targetListeners.delete(target);
      }
      var removeEventListener = addEventListener(target, callback);
      targetListeners.set(target, removeEventListener);
      return removeEventListener;
    };
  });
  (0, _useLayoutEffect.default)(function () {
    return function () {
      targetListeners.forEach(function (removeListener) {
        removeListener();
      });
      targetListeners.clear();
    };
  }, []);
  return addListener;
}
module.exports = exports.default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHBvcnRzIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJ1c2VFdmVudCIsIl9jcmVhdGVFdmVudEhhbmRsZSIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiX3VzZUxheW91dEVmZmVjdCIsIl91c2VTdGFibGUiLCJvYmoiLCJldmVudCIsIm9wdGlvbnMiLCJ0YXJnZXRMaXN0ZW5lcnMiLCJNYXAiLCJhZGRMaXN0ZW5lciIsImFkZEV2ZW50TGlzdGVuZXIiLCJ0YXJnZXQiLCJjYWxsYmFjayIsInJlbW92ZVRhcmdldExpc3RlbmVyIiwiZ2V0IiwiZGVsZXRlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInNldCIsImZvckVhY2giLCJyZW1vdmVMaXN0ZW5lciIsImNsZWFyIiwibW9kdWxlIl0sInNvdXJjZXMiOlsiaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cbmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7XG5leHBvcnRzLmRlZmF1bHQgPSB1c2VFdmVudDtcblxudmFyIF9jcmVhdGVFdmVudEhhbmRsZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4uL2NyZWF0ZUV2ZW50SGFuZGxlXCIpKTtcblxudmFyIF91c2VMYXlvdXRFZmZlY3QgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuLi91c2VMYXlvdXRFZmZlY3RcIikpO1xuXG52YXIgX3VzZVN0YWJsZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4uL3VzZVN0YWJsZVwiKSk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbi8qKlxuICogQ29weXJpZ2h0IChjKSBGYWNlYm9vaywgSW5jLiBhbmQgaXRzIGFmZmlsaWF0ZXMuXG4gKlxuICogVGhpcyBzb3VyY2UgY29kZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UgZm91bmQgaW4gdGhlXG4gKiBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoaXMgc291cmNlIHRyZWUuXG4gKlxuICogXG4gKi9cblxuLyoqXG4gKiBUaGlzIGNhbiBiZSB1c2VkIHdpdGggYW55IGV2ZW50IHR5cGUgaW5jbHVkZSBjdXN0b20gZXZlbnRzLlxuICpcbiAqIGNvbnN0IGNsaWNrID0gdXNlRXZlbnQoJ2NsaWNrJywgb3B0aW9ucyk7XG4gKiB1c2VFZmZlY3QoKCkgPT4ge1xuICogICBjbGljay5zZXRMaXN0ZW5lcih0YXJnZXQsIG9uQ2xpY2spO1xuICogICByZXR1cm4gKCkgPT4gY2xpY2suY2xlYXIoKTtcbiAqIH0pLlxuICovXG5mdW5jdGlvbiB1c2VFdmVudChldmVudCwgb3B0aW9ucykge1xuICB2YXIgdGFyZ2V0TGlzdGVuZXJzID0gKDAsIF91c2VTdGFibGUuZGVmYXVsdCkoZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBuZXcgTWFwKCk7XG4gIH0pO1xuICB2YXIgYWRkTGlzdGVuZXIgPSAoMCwgX3VzZVN0YWJsZS5kZWZhdWx0KShmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGFkZEV2ZW50TGlzdGVuZXIgPSAoMCwgX2NyZWF0ZUV2ZW50SGFuZGxlLmRlZmF1bHQpKGV2ZW50LCBvcHRpb25zKTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhcmdldCwgY2FsbGJhY2spIHtcbiAgICAgIHZhciByZW1vdmVUYXJnZXRMaXN0ZW5lciA9IHRhcmdldExpc3RlbmVycy5nZXQodGFyZ2V0KTtcblxuICAgICAgaWYgKHJlbW92ZVRhcmdldExpc3RlbmVyICE9IG51bGwpIHtcbiAgICAgICAgcmVtb3ZlVGFyZ2V0TGlzdGVuZXIoKTtcbiAgICAgIH1cblxuICAgICAgaWYgKGNhbGxiYWNrID09IG51bGwpIHtcbiAgICAgICAgdGFyZ2V0TGlzdGVuZXJzLmRlbGV0ZSh0YXJnZXQpO1xuICAgICAgfVxuXG4gICAgICB2YXIgcmVtb3ZlRXZlbnRMaXN0ZW5lciA9IGFkZEV2ZW50TGlzdGVuZXIodGFyZ2V0LCBjYWxsYmFjayk7XG4gICAgICB0YXJnZXRMaXN0ZW5lcnMuc2V0KHRhcmdldCwgcmVtb3ZlRXZlbnRMaXN0ZW5lcik7XG4gICAgICByZXR1cm4gcmVtb3ZlRXZlbnRMaXN0ZW5lcjtcbiAgICB9O1xuICB9KTtcbiAgKDAsIF91c2VMYXlvdXRFZmZlY3QuZGVmYXVsdCkoZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICB0YXJnZXRMaXN0ZW5lcnMuZm9yRWFjaChmdW5jdGlvbiAocmVtb3ZlTGlzdGVuZXIpIHtcbiAgICAgICAgcmVtb3ZlTGlzdGVuZXIoKTtcbiAgICAgIH0pO1xuICAgICAgdGFyZ2V0TGlzdGVuZXJzLmNsZWFyKCk7XG4gICAgfTtcbiAgfSwgW10pO1xuICByZXR1cm4gYWRkTGlzdGVuZXI7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gZXhwb3J0cy5kZWZhdWx0OyJdLCJtYXBwaW5ncyI6IkFBQUEsWUFBWTs7QUFFWkEsT0FBTyxDQUFDQyxVQUFVLEdBQUcsSUFBSTtBQUN6QkQsT0FBTyxDQUFDRSxPQUFPLEdBQUdDLFFBQVE7QUFFMUIsSUFBSUMsa0JBQWtCLEdBQUdDLHNCQUFzQixDQUFDQyxPQUFPLHVCQUF1QixDQUFDLENBQUM7QUFFaEYsSUFBSUMsZ0JBQWdCLEdBQUdGLHNCQUFzQixDQUFDQyxPQUFPLHFCQUFxQixDQUFDLENBQUM7QUFFNUUsSUFBSUUsVUFBVSxHQUFHSCxzQkFBc0IsQ0FBQ0MsT0FBTyxlQUFlLENBQUMsQ0FBQztBQUVoRSxTQUFTRCxzQkFBc0JBLENBQUNJLEdBQUcsRUFBRTtFQUFFLE9BQU9BLEdBQUcsSUFBSUEsR0FBRyxDQUFDUixVQUFVLEdBQUdRLEdBQUcsR0FBRztJQUFFUCxPQUFPLEVBQUVPO0VBQUksQ0FBQztBQUFFO0FBb0I5RixTQUFTTixRQUFRQSxDQUFDTyxLQUFLLEVBQUVDLE9BQU8sRUFBRTtFQUNoQyxJQUFJQyxlQUFlLEdBQUcsQ0FBQyxDQUFDLEVBQUVKLFVBQVUsQ0FBQ04sT0FBTyxFQUFFLFlBQVk7SUFDeEQsT0FBTyxJQUFJVyxHQUFHLENBQUMsQ0FBQztFQUNsQixDQUFDLENBQUM7RUFDRixJQUFJQyxXQUFXLEdBQUcsQ0FBQyxDQUFDLEVBQUVOLFVBQVUsQ0FBQ04sT0FBTyxFQUFFLFlBQVk7SUFDcEQsSUFBSWEsZ0JBQWdCLEdBQUcsQ0FBQyxDQUFDLEVBQUVYLGtCQUFrQixDQUFDRixPQUFPLEVBQUVRLEtBQUssRUFBRUMsT0FBTyxDQUFDO0lBQ3RFLE9BQU8sVUFBVUssTUFBTSxFQUFFQyxRQUFRLEVBQUU7TUFDakMsSUFBSUMsb0JBQW9CLEdBQUdOLGVBQWUsQ0FBQ08sR0FBRyxDQUFDSCxNQUFNLENBQUM7TUFFdEQsSUFBSUUsb0JBQW9CLElBQUksSUFBSSxFQUFFO1FBQ2hDQSxvQkFBb0IsQ0FBQyxDQUFDO01BQ3hCO01BRUEsSUFBSUQsUUFBUSxJQUFJLElBQUksRUFBRTtRQUNwQkwsZUFBZSxDQUFDUSxNQUFNLENBQUNKLE1BQU0sQ0FBQztNQUNoQztNQUVBLElBQUlLLG1CQUFtQixHQUFHTixnQkFBZ0IsQ0FBQ0MsTUFBTSxFQUFFQyxRQUFRLENBQUM7TUFDNURMLGVBQWUsQ0FBQ1UsR0FBRyxDQUFDTixNQUFNLEVBQUVLLG1CQUFtQixDQUFDO01BQ2hELE9BQU9BLG1CQUFtQjtJQUM1QixDQUFDO0VBQ0gsQ0FBQyxDQUFDO0VBQ0YsQ0FBQyxDQUFDLEVBQUVkLGdCQUFnQixDQUFDTCxPQUFPLEVBQUUsWUFBWTtJQUN4QyxPQUFPLFlBQVk7TUFDakJVLGVBQWUsQ0FBQ1csT0FBTyxDQUFDLFVBQVVDLGNBQWMsRUFBRTtRQUNoREEsY0FBYyxDQUFDLENBQUM7TUFDbEIsQ0FBQyxDQUFDO01BQ0ZaLGVBQWUsQ0FBQ2EsS0FBSyxDQUFDLENBQUM7SUFDekIsQ0FBQztFQUNILENBQUMsRUFBRSxFQUFFLENBQUM7RUFDTixPQUFPWCxXQUFXO0FBQ3BCO0FBRUFZLE1BQU0sQ0FBQzFCLE9BQU8sR0FBR0EsT0FBTyxDQUFDRSxPQUFPIiwiaWdub3JlTGlzdCI6W119